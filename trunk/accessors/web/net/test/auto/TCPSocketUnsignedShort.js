exports.setup = function () {
    //  This composite accessor was created by Cape Code.
    //  To run the code, run: 
    //  (cd $PTII/org/terraswarm/accessor/accessors/web/net/test/auto; @node@ ../../../node_modules/@accessors-hosts/node/nodeHostInvoke.js net/test/auto/TCPSocketUnsignedShort)
    //  To regenerate this composite accessor, run:
    //  $PTII/bin/ptinvoke ptolemy.cg.kernel.generic.accessor.AccessorCodeGenerator -language accessor $PTII/./ptolemy/actor/lib/jjs/modules/socket/test/auto/TCPSocketUnsignedShort.xml
    //  to edit the model, run:
    //  $PTII/bin/capecode $PTII/./ptolemy/actor/lib/jjs/modules/socket/test/auto/TCPSocketUnsignedShort.xml

    // Ports: TCPSocketUnsignedShort: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/TypedCompositeActor.java

    // Start: TCPSocketClient: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: TCPSocketClient: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var TCPSocketClient = this.instantiateFromCode('TCPSocketClient', unescape('//%20Copyright%20%28c%29%202015-2017%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A%0A/**%20This%20accessor%20sends%20and/or%20receives%20messages%20from%20a%20TCP%20socket%20at%0A%20*%20%20the%20specified%20host%20and%20port.%20If%20the%20value%20of%20the%20%60port%60%20input%20is%20initially%0A%20*%20%20negative%2C%20then%20this%20accessor%20waits%20until%20it%20receives%20a%20non-negative%20%60port%60%0A%20*%20%20input%20before%20making%20a%20connection.%20Otherwise%2C%0A%20*%20%20upon%20initialization%2C%20it%20initiates%20a%20connection%20to%20the%0A%20*%20%20specified%20server.%20If%20at%20any%20time%20during%20execution%20it%20receives%0A%20*%20%20a%20%27port%27%20input%2C%20then%20it%20will%20close%20any%20open%20socket%20and%2C%20if%20the%20new%0A%20*%20%20%27port%27%20value%20is%20non-negative%2C%20open%0A%20*%20%20a%20new%20socket%20to%20the%20current%20%27host%27%20and%20%27port%27.%0A%20*%0A%20*%20%20When%20the%20connection%20is%20established%2C%20a%20%60true%60%20boolean%20is%20sent%20to%0A%20*%20%20the%20%60connected%60%20output.%20If%20the%20connection%20is%20broken%20during%20execution%2C%20then%20a%20%60false%60%0A%20*%20%20boolean%20is%20sent%20to%20the%20%60connected%60%20output.%20The%20swarmlet%20could%20respond%20to%20this%20by%0A%20*%20%20retrying%20to%20connect%20%28send%20an%20event%20to%20either%20the%20%60port%60%20or%20%60host%60%20input%29.%0A%20*%0A%20*%20%20Whenever%20an%20input%20is%20received%20on%20the%20%60toSend%60%20input%2C%0A%20*%20%20the%20data%20on%20that%20input%20is%20sent%20to%20the%20socket.%20If%20the%20socket%20is%20not%20yet%20open%2C%0A%20*%20%20this%20accessor%20will%2C%20by%20default%2C%20queue%20the%20message%20to%20send%20when%20a%20socket%20next%20opens%2C%0A%20*%20%20unless%20the%20%60discardMessagesBeforeOpen%60%20parameter%20is%20true%2C%20in%20which%20case%2C%0A%20*%20%20input%20messages%20that%20are%20received%20before%20the%20socket%20is%20opened%20will%20be%0A%20*%20%20discarded.%0A%20*%0A%20*%20%20Whenever%20a%20message%20is%20received%20from%20the%20socket%2C%20that%20message%20is%0A%20*%20%20produced%20on%20the%20%60received%60%20output.%0A%20*%0A%20*%20%20When%20%60wrapup%28%29%60%20is%20invoked%2C%20this%20accessor%20closes%20the%20%20connection.%0A%20*%0A%20*%20%20The%20send%20and%20receive%20types%20can%20be%20any%20of%20those%20supported%20by%20the%20host.%0A%20*%20%20The%20list%20of%20supported%20types%20will%20be%20provided%20as%20options%20for%20the%20%60sendType%60%0A%20*%20%20and%20%60receiveType%60%20parameter.%20For%20the%20Ptolemy%20II%20host%2C%20these%20include%20at%0A%20*%20%20least%20%27string%27%2C%20%27number%27%2C%20%27image%27%2C%20and%20a%20variety%20of%20numeric%20types.%0A%20*%0A%20*%20%20If%20both%20ends%20of%20the%20socket%20are%20known%20to%20be%20JavaScript%20clients%2C%0A%20*%20%20then%20you%20should%20use%20the%20%27number%27%20data%20type%20for%20numeric%20data.%0A%20*%20%20If%20one%20end%20or%20the%20other%20is%20not%20JavaScript%2C%20then%0A%20*%20%20you%20can%20use%20more%20specified%20types%20such%20as%20%27float%27%20or%20%27int%27%2C%20if%20they%0A%20*%20%20are%20supported%20by%20the%20host.%20In%20all%20cases%2C%20received%20numeric%0A%20*%20%20data%20will%20be%20converted%20to%20JavaScript%20%27number%27%20when%20emitted.%0A%20*%20%20For%20sent%20data%2C%20this%20will%20try%20to%20convert%20a%20JavaScript%20number%0A%20*%20%20to%20the%20specified%20type.%20The%20type%20%27number%27%20is%20equivalent%0A%20*%20%20to%20%27double%27.%0A%20*%0A%20*%20%20When%20type%20conversions%20are%20needed%2C%20e.g.%20when%20you%20send%20a%20double%0A%20*%20%20with%20%60sendType%60%20set%20to%20int%2C%20or%20an%20int%20with%20%60sendType%60%20set%20to%20byte%2C%0A%20*%20%20then%20a%20%22primitive%20narrowing%20conversion%22%20will%20be%20applied%2C%20as%20specified%20here%3A%0A%20*%20%20%5Bhttps%3A//docs.oracle.com/javase/specs/jls/se8/html/jls-5.html%23jls-5.1.3%5D%28https%3A//docs.oracle.com/javase/specs/jls/se8/html/jls-5.html%23jls-5.1.3%29.%0A%20*%0A%20*%20%20For%20numeric%20types%2C%20you%20can%20also%20send%20an%20array%20all%20at%20once%20by%20providing%20an%0A%20*%20%20array%20to%20the%20%60toSend%60%20input%20port.%0A%20*%20%20The%20elements%20of%20the%20array%20will%20be%20sent%20in%20sequence%20all%0A%20*%20%20at%20once%2C%20and%20may%20be%20received%20in%20one%20batch.%20If%20both%20ends%20have%0A%20*%20%20%60rawBytes%60%20set%20to%20false%20%28specifying%20message%20framing%29%2C%20then%20these%0A%20*%20%20elements%20will%20be%20emitted%20at%20the%20receiving%20end%20all%20at%20once%20in%20a%20single%0A%20*%20%20array.%20Otherwise%2C%20they%20will%20be%20emitted%20one%20at%20a%20time.%0A%20*%0A%20*%20%20For%20strings%2C%20you%20can%20also%20send%20an%20array%20of%20strings%20in%20a%20single%20call%2C%0A%20*%20%20but%20these%20will%20be%20simply%20be%20concatenated%20and%20received%20as%20a%20single%20string.%0A%20*%0A%20*%20%20If%20the%20%60rawBytes%60%20option%20is%20set%20to%20false%2C%20then%20each%20data%20item%20provided%20on%20%60toSend%60%2C%0A%20*%20%20of%20any%20type%20or%20array%20of%20types%2C%20will%20be%20coalesced%20into%20a%20single%20message%20and%0A%20*%20%20the%20receiving%20end%20%28if%20it%20also%20has%20%60rawBytes%60%20set%20to%20false%29%20will%20emit%20the%20entire%0A%20*%20%20message%2C%20and%20only%20the%20message%2C%20exactly%20once.%20%20Otherwise%2C%20a%20message%20may%20get%0A%20*%20%20fragmented%2C%20emitted%20in%20pieces%2C%20or%20coalesced%20with%20subsequent%20messages.%0A%20*%0A%20*%20%20When%20a%20model%20with%20an%20instance%20of%20this%20accessor%20stops%20executing%2C%20there%0A%20*%20%20are%20two%20mechanisms%20by%20which%20data%20in%20transit%20can%20be%20lost.%20In%20both%20cases%2C%20warning%0A%20*%20%20messages%20or%20error%20messages%20will%20be%20issued%20to%20the%20host%20to%20be%20displayed%20or%20otherwise%0A%20*%20%20handled%20as%20the%20host%20sees%20fit.%0A%20*%0A%20*%20%20*%20First%2C%20there%20might%20be%20queued%20messages%20that%20were%20received%20on%20%60toSend%60%20but%20have%20not%20yet%0A%20*%20%20%20%20been%20sent%2C%20either%20because%20the%20socket%20has%20not%20yet%20been%20opened%20or%20because%0A%20*%20%20%20%20it%20was%20closed%20from%20the%20other%20side.%0A%20*%20%20*%20Second%2C%20a%20message%20might%20be%20received%20from%20the%20server%20after%20shutdown%20has%20commenced.%0A%20*%20%20%20%20In%20particular%2C%20received%20messages%20are%20handled%20asynchronously%20by%20a%20handler%20function%0A%20*%20%20%20%20that%20can%20be%20invoked%20at%20any%20time%2C%20and%20that%20handler%20might%20be%20invoked%20after%20it%20is%20no%0A%20*%20%20%20%20longer%20possible%20for%20this%20accessor%20to%20produce%20outputs%20%28it%20has%20entered%20its%20wrapup%0A%20*%20%20%20%20phase%20of%20execution%29.%0A%20*%0A%20*%0A%20*%20%20The%20server%20might%20similarly%20lose%20messages%20by%20the%20same%20two%20mechanisms%20occurring%0A%20*%20%20on%20the%20server%20side.%20In%20that%20case%2C%20messages%20will%20presumably%20be%20displayed%20on%20the%0A%20*%20%20server%20side.%0A%20*%0A%20*%20%20Accessors%20that%20extend%20this%20one%20can%20override%20the%20%60toSendInputHandler%60%20function%0A%20*%20%20to%20customize%20what%20is%20sent.%0A%20*%0A%20*%20%20This%20accessor%20requires%20the%20%27socket%27%20module.%0A%20*%0A%20*%20%20@accessor%20net/TCPSocketClient%0A%20*%0A%20*%20%20@input%20%7Bstring%7D%20host%20The%20IP%20address%20or%20domain%20name%20of%20server.%20Defaults%20to%20%27localhost%27.%0A%20*%20%20@input%20%7Bint%7D%20port%20The%20port%20on%20the%20server%20to%20connect%20to.%20Defaults%20to%20-1%2C%20which%20means%0A%20*%20%20%20wait%20for%20a%20non-negative%20input%20before%20connecting.%0A%20*%20%20@input%20toSend%20The%20data%20to%20be%20sent%20over%20the%20socket.%0A%20*%20%20@output%20%7Bboolean%7D%20connected%20Output%20%60true%60%20on%20connected%20and%20%60false%60%20on%20disconnected.%0A%20*%20%20@output%20received%20The%20data%20received%20from%20the%20web%20socket%20server.%0A%20*%0A%20*%20%20@parameter%20%7Bint%7D%20connectTimeout%20The%20time%20to%20wait%20%28in%20milliseconds%29%20before%20declaring%0A%20*%20%20%20%20a%20connection%20attempt%20to%20have%20failed.%20This%20defaults%20to%206000.%0A%20*%20%20@parameter%20%7Bint%7D%20idleTimeout%20The%20amount%20of%20idle%20time%20in%20seconds%20that%20will%20cause%0A%20*%20%20%20%20a%20disconnection%20of%20a%20socket.%20This%20defaults%20to%200%2C%20which%20means%20no%0A%20*%20%20%20%20timeout.%0A%20*%20%20@parameter%20%7Bboolean%7D%20discardMessagesBeforeOpen%20If%20true%2C%20then%20discard%20any%20messages%0A%20*%20%20%20%20passed%20to%20SocketClient.send%28%29%20before%20the%20socket%20is%20opened.%20If%20false%2C%0A%20*%20%20%20%20then%20queue%20the%20messages%20to%20be%20sent%20when%20the%20socket%20opens.%20This%0A%20*%20%20%20%20defaults%20to%20false.%0A%20*%20%20@parameter%20%7Bboolean%7D%20keepAlive%20Whether%20to%20keep%20a%20connection%20alive%20and%20reuse%20it.%20This%0A%20*%20%20%20%20defaults%20to%20true.%0A%20*%20%20@parameter%20%7Bint%7D%20maxUnsentMessages%20The%20maximum%20number%20of%20unsent%20messages%20to%20queue%20before%0A%20*%20%20%20%20further%20calls%20to%20this.send%28%29%20will%20fail.%20A%20value%20of%200%20means%20no%20limit.%0A%20*%20%20%20%20This%20defaults%20to%20100.%0A%20*%20%20@parameter%20%7Bboolean%7D%20noDelay%20If%20true%2C%20data%20as%20sent%20as%20soon%20as%20it%20is%20available%20%28the%20default%29.%0A%20*%20%20%20%20If%20false%2C%20data%20may%20be%20accumulated%20until%20a%20reasonable%20packet%20size%20is%20formed%0A%20*%20%20%20%20in%20order%20to%20make%20more%20efficient%20use%20of%20the%20network%20%28using%20Nagle%27s%20algorithm%29.%0A%20*%20%20@parameter%20%7Bstring%7D%20pfxKeyCertPassword%20If%20sslTls%20is%20set%20to%20true%20and%20the%20server%20requires%0A%20*%20%20%20%20client%20authentication%2C%20then%20this%20option%20needs%20to%20specify%20the%20password%20for%20the%20pfx%20key-cert%0A%20*%20%20%20%20file%20specified%20by%20pfxKeyCertPath.%0A%20*%20%20@parameter%20%7Bstring%7D%20pfxKeyCertPath%20If%20sslTls%20is%20set%20to%20true%20and%20the%20server%20requires%0A%20*%20%20%20%20client%20authentication%2C%20then%20this%20option%20needs%20to%20specify%20the%20fully%20qualified%20filename%20for%0A%20*%20%20%20%20the%20file%20that%20stores%20the%20private%20key%20and%20certificate%20that%20this%20client%20will%20use%20to%20authenticate%0A%20*%20%20%20%20itself%20to%20the%20server.%20This%20path%20can%20be%20any%20of%20those%20understood%20by%20the%20Ptolemy%20host%2C%0A%20*%20%20%20%20e.g.%20paths%20beginning%20with%20%24CLASSPATH/.%0A%20*%20%20@parameter%20%7Bboolean%7D%20rawBytes%20If%20true%20%28the%20default%29%2C%20then%20transmit%20only%20the%20data%20bytes%20provided%0A%20*%20%20%20%20to%20this.send%28%29%20without%20any%20header.%20If%20false%2C%20then%20prepend%20sent%20data%20with%20length%0A%20*%20%20%20%20information%20and%20assume%20receive%20data%20starts%20with%20length%20information.%0A%20*%20%20%20%20Setting%20this%20false%20on%20both%20ends%20will%20ensure%20that%20each%20data%20item%20passed%20to%0A%20*%20%20%20%20this.send%28%29%20is%20emitted%20once%20in%20its%20entirety%20at%20the%20receiving%20end%2C%20as%20a%20single%0A%20*%20%20%20%20message.%20When%20this%20is%20false%2C%20the%20receiving%20end%20can%20emit%20a%20partially%20received%0A%20*%20%20%20%20message%20or%20could%20concatenate%20two%20messages%20and%20emit%20them%20together.%0A%20*%20%20@parameter%20%7Bint%7D%20receiveBufferSize%20The%20size%20of%20the%20receive%20buffer.%20Defaults%20to%0A%20*%20%20%20%2065536.%0A%20*%20%20@parameter%20%7Bstring%7D%20receiveType%20See%20above.%0A%20*%20%20@parameter%20%7Bint%7D%20reconnectAttempts%20The%20number%20of%20times%20to%20try%20to%20reconnect.%0A%20*%20%20%20%20If%20this%20is%20greater%20than%200%2C%20then%20a%20failure%20to%20attempt%20will%20trigger%0A%20*%20%20%20%20additional%20attempts.%20This%20defaults%20to%2010.%0A%20*%20%20@parameter%20%7Bint%7D%20reconnectInterval%20The%20time%20between%20reconnect%20attempts%2C%20in%0A%20*%20%20%20%20milliseconds.%20This%20defaults%20to%201000%20%281%20second%29.%0A%20*%20%20@parameter%20%7Bint%7D%20sendBufferSize%20The%20size%20of%20the%20receive%20buffer.%20Defaults%20to%0A%20*%20%20%20%2065536.%0A%20*%20%20@parameter%20%7Bstring%7D%20sendType%20See%20above.%0A%20*%20%20@parameter%20%7Bboolean%7D%20sslTls%20Whether%20SSL/TLS%20is%20enabled.%20This%20defaults%20to%20false.%0A%20*%20%20@parameter%20%7Bboolean%7D%20trustAll%20Whether%20to%20trust%20servers.%20This%20defaults%20to%20false.%0A%20*%20%20%20%20Setting%20it%20to%20true%20means%20that%20if%20sslTls%20is%20set%20to%20true%2C%20then%0A%20*%20%20%20%20any%20certificate%20provided%20by%20the%20server%20will%20be%20trusted.%0A%20*%20%20%20%20FIXME%3A%20Need%20to%20provide%20a%20trusted%20list%20if%20this%20is%20false.%0A%20*%20%20@parameter%20%7Bstring%7D%20trustedCACertPath%20If%20sslTls%20is%20set%20to%20true%20and%20trustAll%20is%0A%20*%20%20%20%20set%20to%20false%2C%20then%20this%20option%20needs%20to%20specify%20the%20fully%20qualified%20filename%0A%20*%20%20%20%20for%20the%20file%20that%20stores%20the%20certificate%20of%20a%20certificate%20authority%20%28CA%29%20that%0A%20*%20%20%20%20this%20client%20will%20use%20to%20verify%20server%20certificates.%20This%20path%20can%20be%20any%20of%20those%0A%20*%20%20%20%20understood%20by%20the%20Ptolemy%20host%2C%20e.g.%20paths%20beginning%20with%20%24CLASSPATH/.%0A%20*%20%20%20%20FIXME%3A%20Need%20to%20be%20a%20list%20of%20paths%20for%20certificates%20rather%20than%20a%20single%20path.%0A%20*%0A%20*%20%20@author%20Edward%20A.%20Lee%2C%20Hokeun%20Kim%2C%20Contributor%3A%20Matt%20Weber%0A%20*%20%20@version%20%24%24Id%3A%20TCPSocketClient.js%201708%202017-05-17%2018%3A46%3A48Z%20cxh%20%24%24%0A%20*/%0A%0A//%20Stop%20extra%20messages%20from%20jslint.%20%20Note%20that%20there%20should%20be%20no%0A//%20space%20between%20the%20/%20and%20the%20*%20and%20global.%0A/*global%20console%2C%20error%2C%20exports%2C%20getParameter%2C%20require%20*/%0A/*jshint%20globalstrict%3A%20true%20*/%0A%22use%20strict%22%3B%0A%0Avar%20socket%20%3D%20require%28%27@accessors-modules/socket%27%29%3B%0Avar%20openSocket%20%3D%20false%3B%20//%20state%20variable%20used%20for%20isOpen%20function.%0Avar%20client%20%3D%20null%3B%0Avar%20running%20%3D%20false%3B%0Avar%20pendingSends%20%3D%20%5B%5D%3B%0Avar%20previousHost%2C%20previousPort%3B%0A%0A/**%20Set%20up%20the%20accessor%20by%20defining%20the%20parameters%2C%20inputs%2C%20and%20outputs.%20*/%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20setup%28%29%20start%27%29%3B%0A%20%20%20%20this.input%28%27host%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27localhost%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.input%28%27port%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27int%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20-1%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20//%20This%20input%20is%20added%20after%20host%20and%20port%20so%20that%20if%20there%20are%0A%20%20%20%20//%20simultaneous%20inputs%2C%20host%20and%20port%20are%20handled%20first.%0A%20%20%20%20this.input%28%27toSend%27%29%3B%0A%0A%20%20%20%20this.output%28%27connected%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.output%28%27received%27%29%3B%0A%0A%20%20%20%20//%20The%20parameters%20are%20in%20alphabetical%20order.%0A%20%20%20%20this.parameter%28%27connectTimeout%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%206000%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27discardMessagesBeforeOpen%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20false%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27idleTimeout%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%200%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27keepAlive%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27maxUnsentMessages%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%20100%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27noDelay%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27pfxKeyCertPassword%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27pfxKeyCertPath%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27rawBytes%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20false%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27receiveBufferSize%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%2065536%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27receiveType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27string%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27reconnectAttempts%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27int%27%2C%0A%20%20%20%20%20%20%20%20value%3A%2010%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27reconnectInterval%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27int%27%2C%0A%20%20%20%20%20%20%20%20value%3A%201000%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27sendBufferSize%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%2065536%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27sendType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27string%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27sslTls%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20false%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27trustAll%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20false%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27trustedCACertPath%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27%27%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20//%20Attempt%20to%20add%20a%20list%20of%20options%20for%20types%2C%20but%20do%20not%20error%20out%0A%20%20%20%20//%20if%20the%20socket%20module%20is%20not%20supported%20by%20the%20host.%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20this.parameter%28%27receiveType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3A%20socket.supportedReceiveTypes%28%29%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20this.parameter%28%27sendType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3A%20socket.supportedSendTypes%28%29%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%20catch%20%28err%29%20%7B%0A%20%20%20%20%20%20%20%20this.error%28err%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20setup%28%29%20end%27%29%3B%0A%7D%3B%0A%0A%0A/**%20Send%20the%20specified%20data%20if%20the%20client%20is%20set%20and%20open%2C%0A%20*%20%20reconnect%20the%20client%20if%20the%20socket%20is%20closed%2C%20and%20otherwise%20either%0A%20*%20%20discard%20or%20queue%20the%20data%20to%20send%20later%20depending%20on%20the%20value%20of%0A%20*%20%20%60discardMessagesBeforeOpen%60.%0A%20*/%0Aexports.send%20%3D%20function%20%28data%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20send%28%29%27%29%3B%0A%20%20%20%20//%20May%20be%20receiving%20inputs%20before%20client%20has%20been%20set.%0A%0A%20%20%20%20if%20%28client%20%26%26%20exports.isOpen%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20client.send%28data%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28client%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20In%20case%20the%20server%20has%20closed%20the%20socket%2C%20reconnect.%0A%20%20%20%20%20%20%20%20%20%20%20%20this.exports.connect.call%28this%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20client.send%28data%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21getParameter%28%27discardMessagesBeforeOpen%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20maxUnsentMessages%20%3D%20getParameter%28%27maxUnsentMessages%27%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28maxUnsentMessages%20%3E%200%20%26%26%20pendingSends.length%20%3E%3D%20maxUnsentMessages%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.error%28%22Maximum%20number%20of%20unsent%20messages%20has%20been%20exceeded%3A%20%22%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20maxUnsentMessages%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22.%20Consider%20setting%20discardMessagesBeforeOpen%20to%20true.%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pendingSends.push%28data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.log%28%27Discarding%20data%20because%20TCP%20Socket%20Client%20has%20not%20yet%20been%20set%20up.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%3B%0A%0A/**%20Handle%20input%20on%20%27toSend%27%20by%20sending%20the%20specified%20data%20to%20the%20server.%20*/%0Aexports.toSendInputHandler%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20toSendInputHandler%28%29%27%29%3B%0A%20%20%20%20this.exports.send.call%28this%2C%20this.get%28%27toSend%27%29%29%3B%0A%7D%3B%0A%0A/**%20Set%20up%20input%20handlers%2C%20and%20if%20the%20current%20value%20of%20the%20%27port%27%20input%20is%0A%20*%20%20non-negative%2C%20initiate%20a%20connection%20to%20the%20server%20using%20the%0A%20*%20%20current%20parameter%20values%2C%20and%0A%20*%20%20set%20up%20handlers%20for%20for%20establishment%20of%20the%20connection%2C%20incoming%20data%2C%0A%20*%20%20errors%2C%20and%20closing%20from%20the%20server.%0A%20*/%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20initialize%28%29%27%29%3B%0A%20%20%20%20this.addInputHandler%28%27host%27%2C%20this.exports.connect.bind%28this%29%29%3B%0A%20%20%20%20this.addInputHandler%28%27port%27%2C%20this.exports.connect.bind%28this%29%29%3B%0A%20%20%20%20this.addInputHandler%28%27toSend%27%2C%20this.exports.toSendInputHandler.bind%28this%29%29%3B%0A%20%20%20%20this.exports.connect.call%28this%29%3B%0A%20%20%20%20running%20%3D%20true%3B%0A%7D%3B%0A%0A%0A/**%20Function%20is%20called%20by%20client%20when%20data%20has%20been%20received%20over%20the%20connection.%0A%20*%20%20%20This%20has%20been%20refactored%20out%20of%20exports.connect%20to%20facilitate%20overriding%20by%20an%0A%20*%20%20%20extending%20accessor.%0A%20*/%0Aexports.dataReceivedHandler%20%3D%20function%20%28data%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20dataReceiveHandler%28%29%20data%3A%20%27%20+%20data%29%3B%0A%20%20%20%20this.send%28%27received%27%2C%20data%29%3B%0A%7D%3B%0A%0A/**%20Initiate%20a%20connection%20to%20the%20server%20using%20the%20current%20parameter%20values%2C%0A%20*%20%20set%20up%20handlers%20for%20for%20establishment%20of%20the%20connection%2C%20incoming%20data%2C%0A%20*%20%20errors%2C%20and%20closing%20from%20the%20server%2C%20and%20set%20up%20a%20handler%20for%20inputs%0A%20*%20%20on%20the%20toSend%28%29%20input%20port.%0A%20*/%0Aexports.connect%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20connect%28%29%27%29%3B%0A%20%20%20%20//%20Note%20that%20if%20%27host%27%20and%20%27port%27%20both%20receive%20new%20data%20in%20the%20same%0A%20%20%20%20//%20reaction%2C%20then%20this%20will%20be%20invoked%20twice.%20But%20we%20only%20want%20to%20open%0A%20%20%20%20//%20the%20socket%20once.%20%20This%20is%20fairly%20tricky.%0A%0A%20%20%20%20var%20portValue%20%3D%20this.get%28%27port%27%29%3B%0A%20%20%20%20if%20%28portValue%20%3C%200%29%20%7B%0A%20%20%20%20%20%20%20%20//%20No%20port%20is%20specified.%20This%20could%20be%20a%20signal%20to%20close%20a%20previously%0A%20%20%20%20%20%20%20%20//%20open%20socket.%0A%20%20%20%20%20%20%20%20if%20%28client%20%26%26%20exports.isOpen%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20client.close%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20previousPort%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20previousHost%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20var%20hostValue%20%3D%20this.get%28%27host%27%29%3B%0A%20%20%20%20if%20%28previousHost%20%3D%3D%3D%20hostValue%20%26%26%20previousPort%20%3D%3D%3D%20portValue%29%20%7B%0A%20%20%20%20%20%20%20%20//%20A%20request%20to%20open%20a%20client%20for%20this%20host/port%20pair%20has%20already%0A%20%20%20%20%20%20%20%20//%20been%20made%20and%20has%20not%20yet%20been%20closed%20or%20failed%20with%20an%20error.%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20//%20Record%20the%20host/port%20pair%20that%20we%20are%20now%20opening.%0A%20%20%20%20previousHost%20%3D%20hostValue%3B%0A%20%20%20%20previousPort%20%3D%20portValue%3B%0A%0A%20%20%20%20if%20%28client%20%26%26%20exports.isOpen%28%29%29%20%7B%0A%20%20%20%20%20%20%20%20//%20Either%20the%20host%20or%20the%20port%20has%20changed.%20Close%20the%20previous%20socket.%0A%20%20%20%20%20%20%20%20client.close%28%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20//%20Create%20a%20new%20SocketClient.%0A%20%20%20%20client%20%3D%20new%20socket.SocketClient%28portValue%2C%20hostValue%2C%20%7B%0A%20%20%20%20%20%20%20%20%27connectTimeout%27%3A%20this.getParameter%28%27connectTimeout%27%29%2C%0A%20%20%20%20%20%20%20%20%27discardMessagesBeforeOpen%27%3A%20this.getParameter%28%27discardMessagesBeforeOpen%27%29%2C%0A%20%20%20%20%20%20%20%20%27idleTimeout%27%3A%20this.getParameter%28%27idleTimeout%27%29%2C%0A%20%20%20%20%20%20%20%20%27keepAlive%27%3A%20this.getParameter%28%27keepAlive%27%29%2C%0A%20%20%20%20%20%20%20%20%27maxUnsentMessages%27%3A%20this.getParameter%28%27maxUnsentMessages%27%29%2C%0A%20%20%20%20%20%20%20%20%27noDelay%27%3A%20this.getParameter%28%27noDelay%27%29%2C%0A%20%20%20%20%20%20%20%20%27pfxKeyCertPassword%27%3A%20this.getParameter%28%27pfxKeyCertPassword%27%29%2C%0A%20%20%20%20%20%20%20%20%27pfxKeyCertPath%27%3A%20this.getParameter%28%27pfxKeyCertPath%27%29%2C%0A%20%20%20%20%20%20%20%20%27rawBytes%27%3A%20this.getParameter%28%27rawBytes%27%29%2C%0A%20%20%20%20%20%20%20%20%27receiveBufferSize%27%3A%20this.getParameter%28%27receiveBufferSize%27%29%2C%0A%20%20%20%20%20%20%20%20%27receiveType%27%3A%20this.getParameter%28%27receiveType%27%29%2C%0A%20%20%20%20%20%20%20%20%27reconnectAttempts%27%3A%20this.getParameter%28%27reconnectAttempts%27%29%2C%0A%20%20%20%20%20%20%20%20%27reconnectInterval%27%3A%20this.getParameter%28%27reconnectInterval%27%29%2C%0A%20%20%20%20%20%20%20%20%27sendBufferSize%27%3A%20this.getParameter%28%27sendBufferSize%27%29%2C%0A%20%20%20%20%20%20%20%20%27sendType%27%3A%20this.getParameter%28%27sendType%27%29%2C%0A%20%20%20%20%20%20%20%20%27sslTls%27%3A%20this.getParameter%28%27sslTls%27%29%2C%0A%20%20%20%20%20%20%20%20%27trustAll%27%3A%20this.getParameter%28%27trustAll%27%29%2C%0A%20%20%20%20%20%20%20%20%27trustedCACertPath%27%3A%20this.getParameter%28%27trustedCACertPath%27%29%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20var%20self%20%3D%20this%3B%0A%0A%20%20%20%20client.on%28%27open%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketClient%3A%20open%3A%20Connection%20established%27%29%3B%0A%20%20%20%20%20%20%20%20self.send%28%27connected%27%2C%20true%29%3B%0A%0A%20%20%20%20%20%20%20%20//%20If%20there%20are%20pending%20sends%2C%20send%20them%20now.%0A%20%20%20%20%20%20%20%20//%20Note%20this%20implementation%20requires%20that%20the%20host%20invoke%0A%20%20%20%20%20%20%20%20//%20this%20callback%20function%20atomically%20w.r.t.%20the%20input%20handler%0A%20%20%20%20%20%20%20%20//%20that%20adds%20messages%20to%20the%20pendingSends%20queue.%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20pendingSends.length%3B%20i++%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20client.send%28pendingSends%5Bi%5D%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20pendingSends%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20openSocket%20%3D%20true%3B%20//Update%20state%20variable%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20client.on%28%27data%27%2C%20self.exports.dataReceivedHandler.bind%28self%29%29%3B%0A%20%20%20%20client.on%28%27close%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketClient%3A%20close%27%29%3B%0A%20%20%20%20%20%20%20%20previousHost%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20previousPort%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27Connection%20closed.%27%29%3B%0A%20%20%20%20%20%20%20%20//%20NOTE%3A%20Even%20if%20running%20is%20true%2C%20it%20can%20occur%20that%20it%20is%20too%20late%0A%20%20%20%20%20%20%20%20//%20to%20send%20the%20message%20%28the%20wrapup%20process%20has%20been%20started%29%2C%20in%20which%20case%0A%20%20%20%20%20%20%20%20//%20the%20message%20may%20not%20be%20received.%0A%20%20%20%20%20%20%20%20if%20%28running%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27connected%27%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20openSocket%20%3D%20false%3B%20//Update%20state%20variable%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20client.on%28%27error%27%2C%20function%20%28message%29%20%7B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketClient%3A%20error%3A%20%27%20+%20error%29%3B%0A%20%20%20%20%20%20%20%20previousHost%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20previousPort%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20self.error%28message%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20client.open%28%29%3B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20connect%28%29%20end%27%29%3B%0A%7D%3B%0A%0A/**%20Return%20true%20if%20this%20client%20has%20an%20open%20connection%20to%20the%20server.%20*/%0Aexports.isOpen%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20isOpen%28%29%27%29%3B%0A%20%20%20%20return%20openSocket%3B%0A%7D%3B%0A%0A/**%20Close%20the%20web%20socket%20connection.%20*/%0Aexports.wrapup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketClient.js%3A%20wrapup%28%29%27%29%3B%0A%20%20%20%20running%20%3D%20false%3B%0A%20%20%20%20if%20%28client%29%20%7B%0A%20%20%20%20%20%20%20%20client.close%28%29%3B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27Status%3A%20Connection%20closed%20in%20wrapup.%27%29%3B%0A%20%20%20%20%7D%0A%7D%3B%0A'));
    TCPSocketClient.setParameter('receiveType', "unsignedshort");
    TCPSocketClient.setParameter('sendType', "unsignedshort");
    TCPSocketClient.setParameter('rawBytes', true);
    TCPSocketClient.setParameter('pfxKeyCertPassword', "");
    TCPSocketClient.setParameter('pfxKeyCertPath', "");
    TCPSocketClient.setParameter('trustedCACertPath', "");
    TCPSocketClient.setDefault('host', "localhost");
    TCPSocketClient.setDefault('port', -1);
    TCPSocketClient.setParameter('connectTimeout', 6000);
    TCPSocketClient.setParameter('discardMessagesBeforeOpen', false);
    TCPSocketClient.setParameter('idleTimeout', 0);
    TCPSocketClient.setParameter('keepAlive', true);
    TCPSocketClient.setParameter('maxUnsentMessages', 100);
    TCPSocketClient.setParameter('noDelay', true);
    TCPSocketClient.setParameter('receiveBufferSize', 65536);
    TCPSocketClient.setParameter('reconnectAttempts', 10);
    TCPSocketClient.setParameter('reconnectInterval', 1000);
    TCPSocketClient.setParameter('sendBufferSize', 65536);
    TCPSocketClient.setParameter('sslTls', false);
    TCPSocketClient.setParameter('trustAll', false);

    // Start: TCPSocketServer: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: TCPSocketServer: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var TCPSocketServer = this.instantiateFromCode('TCPSocketServer', unescape('//%20Copyright%20%28c%29%202015-2017%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A%0A/**%20This%20accessor%20establishes%20a%20server%20that%20can%20accept%20connection%20requests%20for%0A%20*%20%20a%20TCP%20socket%20and%20can%20send%20and/or%20receives%20messages%20from%20the%20client%20that%20makes%20the%0A%20*%20%20request.%0A%20*%0A%20*%20%20When%20the%20server%20is%20listening%20and%20accepting%20connections%2C%20the%20port%20on%20which%20it%20is%0A%20*%20%20listening%20is%20emitted%20on%20the%20%60listening%60%20output%20port.%0A%20*%0A%20*%20%20When%20a%20connection%20is%20established%2C%20this%20accessor%20outputs%20on%20the%20%60connection%60%20output%0A%20*%20%20an%20object%20with%20the%20following%20properties%3A%0A%20*%0A%20*%20%20*%20**id**%3A%20A%20unique%20ID%20identifying%20the%20connection%20%28a%20positive%20integer%29.%0A%20*%20%20*%20**remoteHost**%3A%20The%20IP%20address%20of%20the%20remote%20host%20for%20the%20socket%20%28a%20string%29.%0A%20*%20%20*%20**remotePort**%3A%20The%20port%20of%20the%20remote%20host%20for%20the%20socket%20%28an%20integer%29.%0A%20*%20%20*%20**status**%3A%20The%20string%20%27open%27.%0A%20*%0A%20*%0A%20*%20%20When%20the%20connection%20is%20closed%2C%20the%20same%20object%20as%20above%20is%20produced%20on%20the%0A%20*%20%20%60connection%60%20output%2C%20except%20with%20status%20being%20%27closed%27.%0A%20*%0A%20*%20%20When%20data%20is%20received%20from%20the%20connection%2C%20two%20outputs%20are%20produced.%0A%20*%20%20The%20data%20itself%20is%20produced%20on%20the%20%60received%60%20output.%20%20The%20ID%20of%20the%20connection%0A%20*%20%20over%20which%20the%20data%20arrived%20is%20produced%20on%20the%20%60receivedID%60%20output.%0A%20*%0A%20*%20%20To%20send%20data%20over%20a%20connection%2C%20provide%20the%20data%20on%20the%20%60toSend%60%20input%20port%0A%20*%20%20and%20the%20ID%20of%20the%20connection%20on%20the%20%60toSendID%60%20input%20port.%20%20To%20send%20to%20all%20open%0A%20*%20%20connections%2C%20provide%20an%20ID%20of%200%20%28zero%29.%0A%20*%0A%20*%20%20The%20send%20and%20receive%20types%20can%20be%20any%20of%20those%20supported%20by%20the%20host.%0A%20*%20%20The%20list%20of%20supported%20types%20will%20be%20provided%20as%20options%20for%20the%20%60sendType%60%0A%20*%20%20and%20%60receiveType%60%20parameter.%20For%20the%20Ptolemy%20II%20host%2C%20these%20include%20at%0A%20*%20%20least%20%27string%27%2C%20%27number%27%2C%20%27image%27%2C%20and%20a%20variety%20of%20numeric%20types.%0A%20*%0A%20*%20%20If%20both%20ends%20of%20the%20socket%20are%20known%20to%20be%20JavaScript%20clients%2C%0A%20*%20%20then%20you%20should%20use%20the%20%27number%27%20data%20type%20for%20numeric%20data.%0A%20*%20%20If%20one%20end%20or%20the%20other%20is%20not%20JavaScript%2C%20then%0A%20*%20%20you%20can%20use%20more%20specified%20types%20such%20as%20%27float%27%20or%20%27int%27%2C%20if%20they%0A%20*%20%20are%20supported%20by%20the%20host.%20In%20all%20cases%2C%20received%20numeric%0A%20*%20%20data%20will%20be%20converted%20to%20JavaScript%20%27number%27%20when%20emitted.%0A%20*%20%20For%20sent%20data%2C%20this%20will%20try%20to%20convert%20a%20JavaScript%20number%0A%20*%20%20to%20the%20specified%20type.%20The%20type%20%27number%27%20is%20equivalent%0A%20*%20%20to%20%27double%27.%0A%20*%0A%20*%20%20When%20type%20conversions%20are%20needed%2C%20e.g.%20when%20you%20send%20a%20double%0A%20*%20%20with%20%60sendType%60%20set%20to%20int%2C%20or%20an%20int%20with%20%60sendType%60%20set%20to%20byte%2C%0A%20*%20%20then%20a%20%22primitive%20narrowing%20conversion%22%20will%20be%20applied%2C%20as%20specified%20here%3A%0A%20*%20%20https%3A//docs.oracle.com/javase/specs/jls/se8/html/jls-5.html%23jls-5.1.3%20.%0A%20*%0A%20*%20%20For%20numeric%20types%2C%20you%20can%20also%20send%20an%20array%20with%20a%20single%20call%0A%20*%20%20to%20this.send%28%29.%20The%20elements%20of%20the%20array%20will%20be%20sent%20in%20sequence%20all%0A%20*%20%20at%20once%2C%20and%20may%20be%20received%20in%20one%20batch.%20If%20both%20ends%20have%0A%20*%20%20%60rawBytes%60%20set%20to%20false%20%28specifying%20message%20framing%29%2C%20then%20these%0A%20*%20%20elements%20will%20be%20emitted%20at%20the%20receiving%20end%20all%20at%20once%20in%20a%20single%0A%20*%20%20array.%20Otherwise%2C%20they%20will%20be%20emitted%20one%20at%20a%20time.%0A%20*%0A%20*%20%20For%20strings%2C%20you%20can%20also%20send%20an%20array%20of%20strings%20in%20a%20single%20call%2C%0A%20*%20%20but%20these%20will%20be%20simply%20be%20concatenated%20and%20received%20as%20a%20single%20string.%0A%20*%0A%20*%20%20If%20the%20%60rawBytes%60%20option%20is%20set%20to%20false%2C%20then%20each%20data%20item%20that%20arrives%20on%0A%20*%20%20%60toSend%60%2C%20of%20any%20type%20or%20array%20of%20types%2C%20will%20be%20coalesced%20into%20a%20single%20message%20and%0A%20*%20%20the%20receiving%20end%20%28if%20it%20also%20has%20%60rawBytes%60%20set%20to%20false%29%20will%20emit%20the%20entire%0A%20*%20%20message%2C%20and%20only%20the%20message%2C%20exactly%20once.%20%20Otherwise%2C%20a%20message%20may%20get%0A%20*%20%20fragmented%2C%20emitted%20in%20pieces%2C%20or%20coalesced%20with%20subsequent%20messages.%0A%20*%0A%20*%20%20When%20a%20model%20with%20an%20instance%20of%20this%20accessor%20stops%20executing%2C%20there%0A%20*%20%20are%20two%20mechanisms%20by%20which%20data%20in%20transit%20can%20be%20lost.%20In%20both%20cases%2C%20warning%0A%20*%20%20messages%20or%20error%20messages%20will%20be%20issued%20to%20the%20host%20to%20be%20displayed%20or%20otherwise%0A%20*%20%20handled%20as%20the%20host%20sees%20fit.%0A%20*%0A%20*%20%20*%20First%2C%20there%20might%20be%20queued%20messages%20that%20were%20received%20on%20%60toSend%60%20but%20have%20not%20yet%0A%20*%20%20%20%20been%20sent%2C%20either%20because%20the%20socket%20has%20not%20yet%20been%20opened%20or%20because%0A%20*%20%20%20%20it%20was%20closed%20from%20the%20other%20side.%0A%20*%20%20*%20Second%2C%20a%20message%20might%20be%20received%20from%20the%20server%20after%20shutdown%20has%20commenced.%0A%20*%20%20%20%20In%20particular%2C%20received%20messages%20are%20handled%20asynchronously%20by%20a%20handler%20function%0A%20*%20%20%20%20that%20can%20be%20invoked%20at%20any%20time%2C%20and%20that%20handler%20might%20be%20invoked%20after%20it%20is%20no%0A%20*%20%20%20%20longer%20possible%20for%20this%20accessor%20to%20produce%20outputs%20%28it%20has%20entered%20its%20wrapup%0A%20*%20%20%20%20phase%20of%20execution%29.%0A%20*%0A%20*%0A%20*%20%20The%20client%20might%20similarly%20lose%20messages%20by%20the%20same%20two%20mechanisms%20occurring%0A%20*%20%20on%20the%20client%20side.%20In%20that%20case%2C%20messages%20will%20presumably%20be%20displayed%20on%20the%0A%20*%20%20client%20side.%0A%20*%0A%20*%20%20Accessors%20that%20extend%20this%20one%20can%20override%20the%20%60toSendInputHandler%60%20function%0A%20*%20%20to%20customize%20what%20is%20sent.%0A%20*%0A%20*%20%20This%20accessor%20requires%20the%20%27socket%27%20module.%0A%20*%0A%20*%20%20@accessor%20net/TCPSocketServer%0A%20*%0A%20*%20%20@input%20toSend%20The%20data%20to%20be%20sent%20over%20the%20socket.%0A%20*%20%20@input%20toSendID%20The%20ID%20of%20the%20connection%20over%20which%20to%20send%20the%20data%2C%20where%200%20means%0A%20*%20%20%20%20to%20send%20to%20all%20open%20connections.%0A%20*%20%20@output%20%7Bint%7D%20listening%20When%20the%20server%20is%20listening%20for%20connections%2C%20this%20output%0A%20*%20%20%20%20will%20produce%20the%20port%20number%20that%20the%20server%20is%20listening%20on%0A%20*%20%20%20%20%28this%20is%20useful%20if%20the%20port%20is%20specified%20to%20be%200%29.%0A%20*%20%20@output%20connection%20Output%20an%20object%20with%20the%20properties%20specified%20above%20when%20a%0A%20*%20%20%20%20%20connection%20is%20established.%0A%20*%20%20@output%20received%20The%20data%20received%20from%20the%20web%20socket%20server.%0A%20*%20%20@output%20receivedID%20The%20ID%20of%20the%20connection%20over%20which%20data%20produced%20on%20the%20received%0A%20*%20%20%20%20output%20was%20received.%20This%20is%20a%20positive%20integer%2C%20as%20indicated%20in%20the%20connection%0A%20*%20%20%20%20output.%0A%20*%0A%20*%20%20@parameter%20%7Bstring%7D%20clientAuth%20One%20of%20%27none%27%2C%20%27request%27%2C%20or%20%27required%27%2C%20meaning%0A%20*%20%20%20%20whether%20it%20requires%20that%20a%20certificate%20be%20presented.%0A%20*%20%20@parameter%20%7Bboolean%7D%20discardSendToUnopenedSocket%20If%20true%2C%20then%20discard%20any%20data%0A%20*%20%20%20sent%20to%20a%20socket%20that%20is%20not%20open.%20The%20data%20will%20be%20logged%20using%20console.log%28%29%0A%20*%20%20%20instead.%20This%20defaults%20to%20false.%0A%20*%20%20@parameter%20%7Bstring%7D%20hostInterface%20The%20name%20of%20the%20network%20interface%20to%20use%20for%0A%20*%20%20%20%20listening%2C%20e.g.%20%27localhost%27.%20The%20default%20is%20%270.0.0.0%27%2C%20which%20means%20to%0A%20*%20%20%20%20listen%20on%20all%20available%20interfaces.%0A%20*%20%20@parameter%20%7Bint%7D%20idleTimeout%20The%20amount%20of%20idle%20time%20in%20seconds%20that%20will%20cause%0A%20*%20%20%20%20a%20disconnection%20of%20a%20socket.%20This%20defaults%20to%200%2C%20which%20means%20no%0A%20*%20%20%20%20timeout.%0A%20*%20%20@parameter%20%7Bboolean%7D%20keepAlive%20Whether%20to%20keep%20a%20connection%20alive%20and%20reuse%20it.%20This%0A%20*%20%20%20%20defaults%20to%20true.%0A%20*%20%20@parameter%20%7Bboolean%7D%20noDelay%20If%20true%2C%20data%20as%20sent%20as%20soon%20as%20it%20is%20available%0A%20*%20%20%20%20%28the%20default%29.%20If%20false%2C%20data%20may%20be%20accumulated%20until%20a%20reasonable%20packet%20size%20is%0A%20*%20%20%20%20formed%20in%20order%20to%20make%20more%20efficient%20use%20of%20the%20network%20%28using%20Nagle%27s%20algorithm%29.%0A%20*%20%20@parameter%20%7Bstring%7D%20pfxKeyCertPassword%20If%20sslTls%20is%20set%20to%20true%2C%20then%20this%20option%0A%20*%20%20%20%20needs%20to%20specify%20the%20password%20for%20the%20pfx%20key-cert%20file%20specified%20by%20pfxKeyCertPath.%0A%20*%20%20@parameter%20%7Bstring%7D%20pfxKeyCertPath%20If%20sslTls%20is%20set%20to%20true%2C%20then%20this%20option%0A%20*%20%20%20%20needs%20to%20specify%20the%20fully%20qualified%20filename%20for%20the%20file%20that%20stores%20the%0A%20*%20%20%20%20private%20key%20and%20certificate%20that%20this%20server%20will%20use%20to%20identify%20itself.%20This%20path%20can%20be%0A%20*%20%20%20%20any%20of%20those%20understood%20by%20the%20Ptolemy%20host%2C%20e.g.%20paths%20beginning%20with%20%24CLASSPATH/.%0A%20*%20%20@parameter%20%7Bint%7D%20port%20The%20default%20port%20to%20listen%20on.%20This%20defaults%20to%204000.%0A%20*%20%20%20%20a%20value%20of%200%20means%20to%20choose%20a%20random%20ephemeral%20free%20port.%0A%20*%20%20@parameter%20%7Bboolean%7D%20rawBytes%20If%20true%20%28the%20default%29%2C%20then%20transmit%20only%20the%20data%20bytes%20provided%0A%20*%20%20%20%20to%20this.send%28%29%20without%20any%20header.%20If%20false%2C%20then%20prepend%20sent%20data%20with%20length%0A%20*%20%20%20%20information%20and%20assume%20receive%20data%20starts%20with%20length%20information.%0A%20*%20%20%20%20Setting%20this%20false%20on%20both%20ends%20will%20ensure%20that%20each%20data%20item%20passed%20to%0A%20*%20%20%20%20this.send%28%29%20is%20emitted%20once%20in%20its%20entirety%20at%20the%20receiving%20end%2C%20as%20a%20single%0A%20*%20%20%20%20message.%20When%20this%20is%20false%2C%20the%20receiving%20end%20can%20emit%20a%20partially%20received%0A%20*%20%20%20%20message%20or%20could%20concatenate%20two%20messages%20and%20emit%20them%20together.%0A%20*%20%20@parameter%20%7Bint%7D%20receiveBufferSize%20The%20size%20of%20the%20receive%20buffer.%20Defaults%20to%0A%20*%20%20%20%2065536.%0A%20*%20%20@parameter%20%7Bstring%7D%20receiveType%20See%20below.%0A%20*%20%20@parameter%20%7Bint%7D%20sendBufferSize%20The%20size%20of%20the%20receive%20buffer.%20Defaults%20to%0A%20*%20%20%20%2065536.%0A%20*%20%20@parameter%20%7Bstring%7D%20sendType%20See%20below.%0A%20*%20%20@parameter%20%7Bboolean%7D%20sslTls%20Whether%20SSL/TLS%20is%20enabled.%20This%20defaults%20to%20false.%0A%20*%20%20@parameter%20%7Bstring%7D%20trustedCACertPath%20If%20sslTls%20is%20set%20to%20true%20and%20this%20server%0A%20*%20%20%20%20requests/requires%20a%20certificate%20from%20the%20client%2C%20then%20this%20option%20needs%20to%20specify%0A%20*%20%20%20%20the%20filename%20for%20the%20file%20that%20stores%20the%20certificate%20of%20a%20certificate%20authority%20%28CA%29%20that%0A%20*%20%20%20%20this%20server%20will%20use%20to%20verify%20client%20certificates.%20This%20path%20can%20be%20any%20of%20those%0A%20*%20%20%20%20understood%20by%20the%20Ptolemy%20host%2C%20e.g.%20paths%20beginning%20with%20%24CLASSPATH/.%0A%20*%20%20%20%20FIXME%3A%20Need%20to%20be%20a%20list%20of%20paths%20for%20certificates%20rather%20than%20a%20single%20path.%0A%20*%0A%20*%20%20@author%20Edward%20A.%20Lee%2C%20Hokeun%20Kim%0A%20*%20%20@version%20%24%24Id%3A%20TCPSocketServer.js%201708%202017-05-17%2018%3A46%3A48Z%20cxh%20%24%24%0A%20*/%0A%0A/*%20These%20are%20needed%20by%20JSLint%2C%20see%20https%3A//chess.eecs.berkeley.edu/ptexternal/wiki/Main/JSLint%20*/%0A//%20Stop%20extra%20messages%20from%20jslint.%20%20Note%20that%20there%20should%20be%20no%0A//%20space%20between%20the%20/%20and%20the%20*%20and%20global.%0A/*global%20addInputHandler%2C%20console%2C%20error%2C%20exports%2C%20get%2C%20getParameter%2C%20input%2C%20onClose%2C%20output%2C%20parameter%2C%20removeInputHandler%2C%20require%2C%20send%20*/%0A/*jshint%20globalstrict%3A%20true%20*/%0A%22use%20strict%22%3B%0A%0Avar%20socket%20%3D%20require%28%27@accessors-modules/socket%27%29%3B%0A%0A/**%20Set%20up%20the%20accessor%20by%20defining%20the%20parameters%2C%20inputs%2C%20and%20outputs.%20*/%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20setup%28%29%20start.%27%29%3B%0A%20%20%20%20this.input%28%27toSend%27%29%3B%0A%20%20%20%20this.input%28%27toSendID%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27int%27%2C%0A%20%20%20%20%20%20%20%20value%3A%200%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.output%28%27listening%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27int%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.output%28%27connection%27%2C%20%7Bspontaneous%3A%20true%7D%29%3B%0A%20%20%20%20this.output%28%27received%27%29%3B%0A%20%20%20%20this.output%28%27receivedID%27%29%3B%0A%0A%20%20%20%20//%20The%20parameters%20below%20are%20listed%20alphabetically.%0A%20%20%20%20this.parameter%28%27clientAuth%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27none%27%20//%20Indicates%20no%20SSL/TSL%20will%20be%20used.%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27discardSendToUnopenedSocket%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20false%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27hostInterface%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%270.0.0.0%27%20//%20Means%20listen%20on%20all%20available%20interfaces.%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27idleTimeout%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%200%2C%20//%20In%20seconds.%200%20means%20don%27t%20timeout.%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27keepAlive%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27noDelay%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27pfxKeyCertPassword%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27pfxKeyCertPath%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27port%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27int%27%2C%0A%20%20%20%20%20%20%20%20value%3A%204000%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27rawBytes%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20false%20//%20Means%20to%20use%20a%20messaging%20protocol.%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27receiveBufferSize%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%2065536%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27receiveType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27string%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27sendBufferSize%27%2C%20%7B%0A%20%20%20%20%20%20%20%20value%3A%2065536%2C%0A%20%20%20%20%20%20%20%20type%3A%20%22int%22%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27sendType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27string%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27sslTls%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20false%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27trustedCACertPath%27%2C%20%7B%0A%20%20%20%20%20%20%20%20type%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20value%3A%20%27%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20//%20Attempt%20to%20add%20a%20list%20of%20options%20for%20types%2C%20but%20do%20not%20error%20out%0A%20%20%20%20//%20if%20the%20socket%20module%20is%20not%20supported%20by%20the%20host.%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20this.parameter%28%27receiveType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3A%20socket.supportedReceiveTypes%28%29%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20this.parameter%28%27sendType%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3A%20socket.supportedSendTypes%28%29%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%20catch%20%28err%29%20%7B%0A%20%20%20%20%20%20%20%20error%28err%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20setup%28%29%20end.%27%29%3B%0A%7D%3B%0A%0Avar%20server%20%3D%20null%3B%0Avar%20connectionCount%20%3D%200%3B%0Avar%20sockets%20%3D%20%5B%5D%3B%0A%0A/**%20Handle%20input%20on%20%27toSend%27%20by%20sending%20to%20one%20or%20all%20of%20the%20open%20sockets%2C%20depending%0A%20*%20%20on%20the%20most%20recently%20received%20value%20on%20the%20%60toSendID%60%20input.%0A%20*/%0Aexports.toSendInputHandler%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20toSendInputHandler%28%29%20start.%27%29%3B%0A%20%20%20%20var%20dataToSend%20%3D%20this.get%28%27toSend%27%29%3B%0A%20%20%20%20var%20idToSendTo%20%3D%20this.get%28%27toSendID%27%29%3B%0A%20%20%20%20if%20%28idToSendTo%20%3D%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20//%20Broadcast%20to%20all%20sockets.%0A%20%20%20%20%20%20%20%20for%20%28var%20i%20%3D%200%3B%20i%20%3C%20sockets.length%3B%20i++%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20toSendInputHandler%28%29%20socket%5B%27%20+%20i%20+%20%27%5D.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28sockets%5Bi%5D%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20toSendInputHandler%28%29%20socket%5B%27%20+%20i%20+%20%27%5D.%20sending%3A%20%27%20+%20dataToSend%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sockets%5Bi%5D.send%28dataToSend%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20toSendInputHandler%28%29%20socket%5B%27%20+%20i%20+%20%27%5D.%20done%20sending%3A%20%27%20+%20dataToSend%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20if%20%28sockets%5BidToSendTo%5D%29%20%7B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20toSendInputHandler%28%29%20socket%5BidToSendTo%5D%3A%20%27%20+%20dataToSend%29%3B%0A%20%20%20%20%20%20%20%20sockets%5BidToSendTo%5D.send%28dataToSend%29%3B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20toSendInputHandler%28%29%20socket%5BidToSendTo%5D%3A%20%27%20+%20dataToSend%20+%20%27%20done.%27%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20var%20discardSendToUnopenedSocket%20%3D%20this.getParameter%28%27discardSendToUnopenedSocket%27%29%3B%0A%20%20%20%20%20%20%20%20if%20%28discardSendToUnopenedSocket%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log%28%27Socket%20with%20ID%20%27%20+%20idToSendTo%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20is%20not%20open.%20Discarding%20data.%27%29%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20error%28%27Attempting%20to%20send%20data%20over%20socket%20with%20id%20%27%20+%20idToSendTo%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%2C%20but%20this%20socket%20is%20not%20open.%27%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20toSendInputHandler%28%29%20end.%27%29%3B%0A%7D%3B%0A%0A/**%20Initialize%20the%20accessor%20by%20starting%20the%20server%20with%20the%20current%20parameter%20values%0A%20*%20%20specifying%20the%20options%2C%20setting%20up%20listeners%20to%20be%20notified%20when%20the%20server%20is%0A%20*%20%20is%20listening%20for%20connections%2C%20when%20a%20client%20requests%20and%20connection%2C%0A%20*%20%20and%20when%20errors%20occur%2C%20and%20setting%20up%20an%20input%20handler%0A%20*%20%20for%20data%20arriving%20on%20the%20toSend%20input.%20When%20a%20client%20requests%20a%20connection%2C%20the%0A%20*%20%20handler%20will%20open%20the%20socket%2C%20send%20a%20%60connection%60%20output%2C%20and%20and%20set%20up%20listeners%0A%20*%20%20for%20incoming%20data%2C%20errors%2C%20and%20closing%20of%20the%20socket%20from%20the%20remote%20site.%0A%20*/%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20initialize%28%29%20start%3A%20port%3A%20%27%20+%20this.getParameter%28%27port%27%29%29%3B%0A%0A%20%20%20%20server%20%3D%20new%20socket.SocketServer%28%7B%0A%20%20%20%20%20%20%20%20%27clientAuth%27%3A%20this.getParameter%28%27clientAuth%27%29%2C%0A%20%20%20%20%20%20%20%20%27hostInterface%27%3A%20this.getParameter%28%27hostInterface%27%29%2C%0A%20%20%20%20%20%20%20%20%27idleTimeout%27%3A%20this.getParameter%28%27idleTimeout%27%29%2C%0A%20%20%20%20%20%20%20%20%27keepAlive%27%3A%20this.getParameter%28%27keepAlive%27%29%2C%0A%20%20%20%20%20%20%20%20%27noDelay%27%3A%20this.getParameter%28%27noDelay%27%29%2C%0A%20%20%20%20%20%20%20%20%27pfxKeyCertPassword%27%3A%20this.getParameter%28%27pfxKeyCertPassword%27%29%2C%0A%20%20%20%20%20%20%20%20%27pfxKeyCertPath%27%3A%20this.getParameter%28%27pfxKeyCertPath%27%29%2C%0A%20%20%20%20%20%20%20%20%27port%27%3A%20this.getParameter%28%27port%27%29%2C%0A%20%20%20%20%20%20%20%20%27rawBytes%27%3A%20this.getParameter%28%27rawBytes%27%29%2C%0A%20%20%20%20%20%20%20%20%27receiveBufferSize%27%3A%20this.getParameter%28%27receiveBufferSize%27%29%2C%0A%20%20%20%20%20%20%20%20%27receiveType%27%3A%20this.getParameter%28%27receiveType%27%29%2C%0A%20%20%20%20%20%20%20%20%27sendBufferSize%27%3A%20this.getParameter%28%27sendBufferSize%27%29%2C%0A%20%20%20%20%20%20%20%20%27sendType%27%3A%20this.getParameter%28%27sendType%27%29%2C%0A%20%20%20%20%20%20%20%20%27sslTls%27%3A%20this.getParameter%28%27sslTls%27%29%2C%0A%20%20%20%20%20%20%20%20%27trustedCACertPath%27%3A%20this.getParameter%28%27trustedCACertPath%27%29%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20var%20self%20%3D%20this%3B%0A%0A%20%20%20%20server.on%28%27error%27%2C%20function%20%28message%29%20%7B%0A%20%20%20%20%20%20%20%20self.error%28message%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20server.on%28%27listening%27%2C%20function%20%28port%29%20%7B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20Listening%20for%20socket%20connection%20requests%20on%20port%20%27%20+%20port%29%3B%0A%20%20%20%20%20%20%20%20self.send%28%27listening%27%2C%20port%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20server.on%28%27connection%27%2C%20function%20%28serverSocket%29%20%7B%0A%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20server%20connection%20listener%3A%20localPort%3A%20%27%20+%20serverSocket.localPort%20+%20%27%2C%20remotePort%3A%20%27%20+%20serverSocket.remotePort%28%29%29%3B%0A%20%20%20%20%20%20%20%20//%20serverSocket%20is%20an%20instance%20of%20the%20Socket%20class%20defined%0A%20%20%20%20%20%20%20%20//%20in%20the%20socket%20module.%0A%20%20%20%20%20%20%20%20connectionCount++%3B%0A%20%20%20%20%20%20%20%20var%20socketInstance%20%3D%20connectionCount%3B%0A%20%20%20%20%20%20%20%20var%20socketID%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%27id%27%3A%20socketInstance%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%27remoteHost%27%3A%20serverSocket.remoteHost%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%27remotePort%27%3A%20serverSocket.remotePort%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%27status%27%3A%20%27open%27%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20self.send%28%27connection%27%2C%20socketID%29%3B%0A%0A%20%20%20%20%20%20%20%20sockets%5BsocketInstance%5D%20%3D%20serverSocket%3B%0A%0A%20%20%20%20%20%20%20%20serverSocket.on%28%27close%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20serverSocket%20close%20listener%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20socketID.status%20%3D%20%27closed%27%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27connection%27%2C%20socketID%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20Avoid%20a%20memory%20leak%20here.%0A%20%20%20%20%20%20%20%20%20%20%20%20sockets%5BsocketInstance%5D%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20serverSocket.on%28%27data%27%2C%20function%20%28data%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20serverSocket%20data%20listener%3A%20%27%20+%20data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20util%20%3D%20require%28%27util%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20console.log%28util.inspect%28data%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27received%27%2C%20data%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27receivedID%27%2C%20socketInstance%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20serverSocket.on%28%27error%27%2C%20function%20%28message%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20serverSocket%20error%20listener%3A%20%27%20+%20message%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.error%28message%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20//%20Open%20the%20server%20after%20setting%20up%20all%20the%20handlers.%0A%20%20%20%20server.start%28%29%3B%0A%0A%20%20%20%20//%20Bind%20the%20input%20handler%20to%20caller%27s%20object%20so%20that%20when%20it%20is%20invoked%2C%0A%20%20%20%20//%20it%20is%20invoked%20in%20the%20context%20of%20that%20object%20and%20not%20this%20one.%0A%20%20%20%20this.addInputHandler%28%27toSend%27%2C%20exports.toSendInputHandler.bind%28this%29%29%3B%0A%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20initialize%28%29%20end%27%29%3B%0A%7D%3B%0A%0A/**%20Close%20all%20sockets%2C%20unregister%20event%20listeners%2C%20and%20stop%20the%20server.%0A%20*/%0Aexports.wrapup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//%20console.log%28%27TCPSocketServer.js%3A%20wrapup%28%29%27%29%3B%0A%20%20%20%20sockets%20%3D%20%5B%5D%3B%0A%0A%20%20%20%20if%20%28server%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20server.stop%28%29%3B%0A%20%20%20%20%20%20%20%20server%20%3D%20null%3B%0A%20%20%20%20%7D%0A%7D%3B%0A'));
    TCPSocketServer.setParameter('clientAuth', "none");
    TCPSocketServer.setParameter('hostInterface', "0.0.0.0");
    TCPSocketServer.setParameter('receiveType', "unsignedshort");
    TCPSocketServer.setParameter('sendType', "unsignedshort");
    TCPSocketServer.setParameter('rawBytes', true);
    TCPSocketServer.setParameter('pfxKeyCertPassword', "");
    TCPSocketServer.setParameter('pfxKeyCertPath', "");
    TCPSocketServer.setParameter('trustedCACertPath', "");
    TCPSocketServer.setParameter('port', 0);
    TCPSocketServer.setDefault('toSendID', 0);
    TCPSocketServer.setParameter('discardSendToUnopenedSocket', false);
    TCPSocketServer.setParameter('idleTimeout', 0);
    TCPSocketServer.setParameter('keepAlive', true);
    TCPSocketServer.setParameter('noDelay', true);
    TCPSocketServer.setParameter('receiveBufferSize', 65536);
    TCPSocketServer.setParameter('sendBufferSize', 65536);
    TCPSocketServer.setParameter('sslTls', false);

    // Start: TrainableTest: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: TrainableTest: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var TrainableTest = this.instantiateFromCode('TrainableTest', unescape('//%20Copyright%20%28c%29%202016-2017%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A/**%20Compare%20the%20input%20with%20a%20known%20good%20input.%0A%20*%20%20If%20you%20set%20%27%27trainingMode%27%27%20to%20true%20and%20provide%20inputs%2C%20then%20the%0A%20*%20%20inputs%20will%20be%20recorded%20in%20the%20%27%27correctValues%27%27%20parameters.%0A%20*%20%20Otherwise%2C%20the%20inputs%20will%20be%20compared%20against%20those%20in%20the%0A%20*%20%20%27%27correctValue%27%27%20parameter.%0A%20*%0A%20*%20%20@accessor%20test/TrainableTest%0A%20*%20%20@input%20input%20The%20input%20value.%0A%20*%20%20@output%20output%20False%20as%20long%20as%20there%20is%20data%20to%20compare%20against%20the%20input%0A%20*%20%20@param%20correctValues%20a%20JSON%20array%20of%20the%20correct%20values.%0A%20*%20%20@param%20trainingMode%20true%20if%20the%20input%20is%20being%20trained.%0A%20*%20%20@author%20Christopher%20Brooks%20based%20on%20the%20Ptolemy%20NonStrictTest%20actor%20by%20Paul%20Whitaker%2C%20Christopher%20Hylands%2C%20Edward%20A.%20Lee%0A%20*%20%20@version%20%24%24Id%3A%20TrainableTest.js%202058%202017-08-16%2023%3A26%3A01Z%20cxh%20%24%24%0A%20*/%0A%0A//%20Stop%20extra%20messages%20from%20jslint%20and%20jshint.%20%20Note%20that%20there%20should%0A//%20be%20no%20space%20between%20the%20/%20and%20the%20*%20and%20global.%20See%0A//%20https%3A//chess.eecs.berkeley.edu/ptexternal/wiki/Main/JSHint%20*/%0A/*globals%20console%2C%20exports*/%0A/*jshint%20globalstrict%3A%20true*/%0A/*jslint%20plusplus%3A%20true%20*/%0A%27use%20strict%27%3B%0A%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.parameter%28%27correctValues%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27value%27%3A%20%5B0%5D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.input%28%27input%27%29%3B%0A%20%20%20%20this.output%28%27output%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27boolean%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27tolerance%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27number%27%2C%0A%20%20%20%20%20%20%20%20%27value%27%3A%200.000000001%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27trainingMode%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20%27value%27%3A%20false%0A%20%20%20%20%7D%29%3B%0A%7D%3B%0A%0A//%20Input%2C%20parameter%20and%20variable%20names%20match%20those%20in%20%24PTII/ptolemy/actor/lib/NonStrictTest.java%0A%0A//%20Set%20to%20true%20if%20an%20input%20is%20handled.%20%20If%20no%20inputs%20are%20handled%2C%20then%0A//%20throw%20an%20exception%20in%20wrapup%28%29.%0Avar%20inputHandled%20%3D%20false%3B%0A%0A//%20Set%20to%20true%20when%20initialize%28%29%20is%20called.%0Avar%20initialized%20%3D%20false%3B%0A%0A//%20The%20number%20of%20input%20tokens%20that%20have%20been%20read%20in.%0Avar%20numberOfInputTokensSeen%20%3D%200%3B%0A%0A//%20If%20trainingMode%20is%20true%2C%20then%20inputs%20that%20have%20been%20seen%20so%20far.%0Avar%20trainingTokens%20%3D%20%5B%5D%3B%0A%0A//%20Set%20to%20false%20in%20initialize%28%29%20and%20true%20at%20the%20end%20of%20wrapup%28%29.%0A//%20FIXME%3A%20We%20should%20have%20an%20exit%20hook%20that%20checks%20that%20wrapup%28%29%20is%20called%20for%20all%20the%20actors.%0Avar%20wrappedUp%20%3D%20false%3B%0A%0A//%20So%20we%20can%20test%20this%20in%20hosts/node/test/mocha/testMain.js%20to%20test%20that%20wrapup%20was%20called.%0Aexports.wrappedUp%20%3D%20wrappedUp%3B%0A%0A/**%20Create%20an%20input%20handler%20to%20compare%20the%20input%20with%20the%20appropriate%20element%28s%29%0A%20*%20%20from%20correctValues.%0A%20*/%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//console.log%28%22Test%20initialize%28%29%3A%20typeof%20correctValues%3A%20%22%20+%20typeof%20this.getParameter%28%27correctValues%27%29%29%0A%20%20%20%20var%20inputValueValue%2C%0A%20%20%20%20%20%20%20%20self%20%3D%20this%3B%0A%0A%20%20%20%20trainingTokens%20%3D%20%5B%5D%3B%0A%20%20%20%20exports.wrappedUp%20%3D%20false%3B%0A%20%20%20%20numberOfInputTokensSeen%20%3D%200%3B%0A%0A%20%20%20%20this.addInputHandler%28%27input%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20cache%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20inputValue%20%3D%20self.get%28%27input%27%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%3B%0A%20%20%20%20%20%20%20%20inputHandled%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20//%20If%20the%20input%20is%20not%20connected%2C%20then%20inputValue%20will%20be%20null.%0A%20%20%20%20%20%20%20%20if%20%28self.getParameter%28%27trainingMode%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20trainingTokens.push%28inputValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20correctValuesValues%20%3D%20self.getParameter%28%27correctValues%27%29%3B%0A%0A%20%20%20%20%20%20%20%20if%20%28numberOfInputTokensSeen%20%3C%20correctValuesValues.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20referenceToken%20%3D%20correctValuesValues%5BnumberOfInputTokensSeen%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20//console.log%28%22Test%3A%20%22%20+%20numberOfInputTokensSeen%20+%20%22%2C%20input%3A%20%22%20+%20inputValue%0A%20%20%20%20%20%20%20%20%20%20%20%20//+%20%22%2C%20referenceToken%3A%20%22%20+%20referenceToken%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%21%3D%3D%20%27boolean%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20%21%3D%3D%20%27number%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20%21%3D%3D%20%27object%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20%21%3D%3D%20%27string%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValue%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20value%20of%20the%20input%20was%20null%3F%20%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27Perhaps%20the%20input%20is%20not%20connected%3F%27%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue.length%20%3E%20100%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValueValue.substring%280%2C%20100%29%20+%20%27...%27%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20null%3B%20//%20Enable%20garbage%20collection%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20neither%20a%20number%20nor%20a%20string%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20+%20%27%20with%20value%20%27%20+%20inputValueValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27boolean%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20the%20input%20not%20a%20boolean%2C%20then%20throw%20an%20error.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%21%3D%3D%20%27boolean%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20not%20a%20boolean%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20+%20%27.%20%20The%20expected%20value%20was%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValue%20%21%3D%3D%20referenceToken%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%20%27%22%20is%20not%20equal%20to%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27number%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20the%20input%20not%20a%20number%2C%20then%20throw%20an%20error.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%21%3D%3D%20%27number%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20not%20a%20number%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20+%20%27.%20%20The%20expected%20value%20was%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20difference%20%3D%20Math.abs%28inputValue%20-%20referenceToken%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28isNaN%28difference%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20absolute%20value%20of%20the%20input%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValue%20+%20%27%22%20-%20the%20referenceToken%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%20is%20NaN%3F%20%20It%20should%20be%20less%20than%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.getParameter%28%27tolerance%27%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28difference%20%3E%20self.getParameter%28%27tolerance%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%20%27%22%20is%20not%20within%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.getParameter%28%27tolerance%27%29%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20of%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27string%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValue%20%21%3D%3D%20referenceToken%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20devices/test/auto/WatchEmulator.js%20needs%20this%20test%20for%20object%20because%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20if%20we%20receive%20a%20JSON%20object%2C%20then%20we%20should%20try%20to%20stringify%20it.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20%28err%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%20%27%22%20is%20%21%3D%3D%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20to%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22.%20%20The%20input%20was%20an%20object%2C%20and%20a%20string%20was%20expected.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%21%3D%3D%20referenceToken%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%20%27%22%20is%20%21%3D%3D%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20to%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22.%20%20The%20input%20was%20an%20object%20and%20JSON.stringify%28%29%20did%20not%20throw%20an%20exception.%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27A%20string%20was%20expected.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20referenceTokenValue%20%3D%20JSON.stringify%28referenceToken%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20null%3B%20//%20Enable%20garbage%20collection%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20we%20are%20comparing%20longs%20from%20CapeCode%2C%20then%20the%20values%20will%20be%20like%20%221L%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20and%20stringify%20will%20return%20undefined.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%3D%3D%3D%20undefined%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28referenceTokenValue%20%3D%3D%3D%20undefined%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceTokenValue%20%3D%20referenceToken%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%21%3D%3D%20referenceTokenValue%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20inputValueValue%20could%20still%20be%20undefined%20here%20if%20inputValue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20was%20undefined.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%21%3D%3D%20undefined%20%26%26%20inputValueValue.length%20%3E%20100%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValueValue.substring%280%2C%20100%29%20+%20%27...%27%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28referenceTokenValue%20%21%3D%3D%20undefined%20%26%26%20referenceTokenValue.length%20%3E%20100%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceTokenValue%20%3D%20referenceTokenValue.substring%280%2C%20100%29%20+%20%27...%27%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Deal%20with%20referenceTokens%20with%20value%201L.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValueValue%20%21%3D%3D%20%27object%27%20%7C%7C%20typeof%20referenceTokenValue%20%21%3D%3D%20%27object%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue.toString%28%29%20%21%3D%3D%20referenceTokenValue.toString%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20%21%3D%3D%20to%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceTokenValue%20+%20%27%22%20typeof%20inputValueValue%3A%20%27%20+%20typeof%20inputValueValue%20+%20%27%20typeof%20referenceTokenValue%3A%20%27%20+%20typeof%20referenceTokenValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20referenceToken%20%22%27%20+%20referenceToken%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20not%20a%20number%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20referenceToken%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20numberOfInputTokensSeen%20+%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20we%20are%20past%20the%20end%20of%20the%20expected%20inputs%2C%20then%20read%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28numberOfInputTokensSeen%20%3E%3D%20correctValuesValues.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20true%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20true%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20initialized%20%3D%20true%3B%0A%7D%3B%0A%0A/**%20If%20trainingMode%20is%20true%2C%20then%20updated%20the%20correctValues.%20*/%0Aexports.wrapup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20if%20%28this.getParameter%28%27trainingMode%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20this.setParameter%28%27correctValues%27%2C%20trainingTokens%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28initialized%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21inputHandled%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20initialized%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28this.accessorName%20+%20%27%3A%20The%20input%20handler%20of%20this%20accessor%20was%20never%20invoked.%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27Usually%2C%20this%20is%20an%20error%20indicating%20that%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27starvation%20is%20occurring.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20correctValuesValues%20%3D%20this.getParameter%28%27correctValues%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28numberOfInputTokensSeen%20%3C%20correctValuesValues.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28this.accessorName%20+%20%27%3A%20The%20test%20produced%20only%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20yet%20the%20correctValues%20parameter%20was%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27expecting%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20correctValuesValues.length%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20initialized%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20name%20%3D%20this.accessorName%3B%0A%0A%20%20%20%20//%20FIXME%3A%20Should%20we%20check%20to%20see%20if%20the%20name%20has%20no%20dots%20in%20and%20if%0A%20%20%20%20//%20it%20does%20not%2C%20add%20the%20container%20name%3F%0A%0A%20%20%20%20//if%20%28this.container%29%20%7B%0A%20%20%20%20//%20%20%20%20name%20%3D%20this.container.accessorName%20+%20%22.%22%20+%20name%3B%0A%20%20%20%20//%7D%0A%0A%20%20%20%20//%0A%20%20%20%20exports.wrappedUp%20%3D%20true%3B%0A%20%20%20%20//%20console.log%28%22TrainableTest.js%3A%20wrapup%28%29%20finished%3A%20%22%20+%20name%20+%20%22%2C%20exports.wrappedUp%3A%20%22%20+%20exports.wrappedUp%29%3B%0A%0A%7D%3B%0A'));
    TrainableTest.setParameter('correctValues', [65535,0,1,65535,0,2]);
    TrainableTest.setParameter('trainingMode', false);
    TrainableTest.setParameter('tolerance', 1.0E-9);

    // Start: TrainableTest2: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: TrainableTest2: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var TrainableTest2 = this.instantiateFromCode('TrainableTest2', unescape('//%20Copyright%20%28c%29%202016-2017%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A/**%20Compare%20the%20input%20with%20a%20known%20good%20input.%0A%20*%20%20If%20you%20set%20%27%27trainingMode%27%27%20to%20true%20and%20provide%20inputs%2C%20then%20the%0A%20*%20%20inputs%20will%20be%20recorded%20in%20the%20%27%27correctValues%27%27%20parameters.%0A%20*%20%20Otherwise%2C%20the%20inputs%20will%20be%20compared%20against%20those%20in%20the%0A%20*%20%20%27%27correctValue%27%27%20parameter.%0A%20*%0A%20*%20%20@accessor%20test/TrainableTest%0A%20*%20%20@input%20input%20The%20input%20value.%0A%20*%20%20@output%20output%20False%20as%20long%20as%20there%20is%20data%20to%20compare%20against%20the%20input%0A%20*%20%20@param%20correctValues%20a%20JSON%20array%20of%20the%20correct%20values.%0A%20*%20%20@param%20trainingMode%20true%20if%20the%20input%20is%20being%20trained.%0A%20*%20%20@author%20Christopher%20Brooks%20based%20on%20the%20Ptolemy%20NonStrictTest%20actor%20by%20Paul%20Whitaker%2C%20Christopher%20Hylands%2C%20Edward%20A.%20Lee%0A%20*%20%20@version%20%24%24Id%3A%20TrainableTest.js%202058%202017-08-16%2023%3A26%3A01Z%20cxh%20%24%24%0A%20*/%0A%0A//%20Stop%20extra%20messages%20from%20jslint%20and%20jshint.%20%20Note%20that%20there%20should%0A//%20be%20no%20space%20between%20the%20/%20and%20the%20*%20and%20global.%20See%0A//%20https%3A//chess.eecs.berkeley.edu/ptexternal/wiki/Main/JSHint%20*/%0A/*globals%20console%2C%20exports*/%0A/*jshint%20globalstrict%3A%20true*/%0A/*jslint%20plusplus%3A%20true%20*/%0A%27use%20strict%27%3B%0A%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.parameter%28%27correctValues%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27value%27%3A%20%5B0%5D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.input%28%27input%27%29%3B%0A%20%20%20%20this.output%28%27output%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27boolean%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27tolerance%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27number%27%2C%0A%20%20%20%20%20%20%20%20%27value%27%3A%200.000000001%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27trainingMode%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20%27value%27%3A%20false%0A%20%20%20%20%7D%29%3B%0A%7D%3B%0A%0A//%20Input%2C%20parameter%20and%20variable%20names%20match%20those%20in%20%24PTII/ptolemy/actor/lib/NonStrictTest.java%0A%0A//%20Set%20to%20true%20if%20an%20input%20is%20handled.%20%20If%20no%20inputs%20are%20handled%2C%20then%0A//%20throw%20an%20exception%20in%20wrapup%28%29.%0Avar%20inputHandled%20%3D%20false%3B%0A%0A//%20Set%20to%20true%20when%20initialize%28%29%20is%20called.%0Avar%20initialized%20%3D%20false%3B%0A%0A//%20The%20number%20of%20input%20tokens%20that%20have%20been%20read%20in.%0Avar%20numberOfInputTokensSeen%20%3D%200%3B%0A%0A//%20If%20trainingMode%20is%20true%2C%20then%20inputs%20that%20have%20been%20seen%20so%20far.%0Avar%20trainingTokens%20%3D%20%5B%5D%3B%0A%0A//%20Set%20to%20false%20in%20initialize%28%29%20and%20true%20at%20the%20end%20of%20wrapup%28%29.%0A//%20FIXME%3A%20We%20should%20have%20an%20exit%20hook%20that%20checks%20that%20wrapup%28%29%20is%20called%20for%20all%20the%20actors.%0Avar%20wrappedUp%20%3D%20false%3B%0A%0A//%20So%20we%20can%20test%20this%20in%20hosts/node/test/mocha/testMain.js%20to%20test%20that%20wrapup%20was%20called.%0Aexports.wrappedUp%20%3D%20wrappedUp%3B%0A%0A/**%20Create%20an%20input%20handler%20to%20compare%20the%20input%20with%20the%20appropriate%20element%28s%29%0A%20*%20%20from%20correctValues.%0A%20*/%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20//console.log%28%22Test%20initialize%28%29%3A%20typeof%20correctValues%3A%20%22%20+%20typeof%20this.getParameter%28%27correctValues%27%29%29%0A%20%20%20%20var%20inputValueValue%2C%0A%20%20%20%20%20%20%20%20self%20%3D%20this%3B%0A%0A%20%20%20%20trainingTokens%20%3D%20%5B%5D%3B%0A%20%20%20%20exports.wrappedUp%20%3D%20false%3B%0A%20%20%20%20numberOfInputTokensSeen%20%3D%200%3B%0A%0A%20%20%20%20this.addInputHandler%28%27input%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20cache%20%3D%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20inputValue%20%3D%20self.get%28%27input%27%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%3B%0A%20%20%20%20%20%20%20%20inputHandled%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20//%20If%20the%20input%20is%20not%20connected%2C%20then%20inputValue%20will%20be%20null.%0A%20%20%20%20%20%20%20%20if%20%28self.getParameter%28%27trainingMode%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20trainingTokens.push%28inputValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20var%20correctValuesValues%20%3D%20self.getParameter%28%27correctValues%27%29%3B%0A%0A%20%20%20%20%20%20%20%20if%20%28numberOfInputTokensSeen%20%3C%20correctValuesValues.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20referenceToken%20%3D%20correctValuesValues%5BnumberOfInputTokensSeen%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20//console.log%28%22Test%3A%20%22%20+%20numberOfInputTokensSeen%20+%20%22%2C%20input%3A%20%22%20+%20inputValue%0A%20%20%20%20%20%20%20%20%20%20%20%20//+%20%22%2C%20referenceToken%3A%20%22%20+%20referenceToken%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%21%3D%3D%20%27boolean%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20%21%3D%3D%20%27number%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20%21%3D%3D%20%27object%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20%21%3D%3D%20%27string%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValue%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20value%20of%20the%20input%20was%20null%3F%20%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27Perhaps%20the%20input%20is%20not%20connected%3F%27%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue.length%20%3E%20100%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValueValue.substring%280%2C%20100%29%20+%20%27...%27%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20null%3B%20//%20Enable%20garbage%20collection%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20neither%20a%20number%20nor%20a%20string%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20+%20%27%20with%20value%20%27%20+%20inputValueValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27boolean%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20the%20input%20not%20a%20boolean%2C%20then%20throw%20an%20error.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%21%3D%3D%20%27boolean%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20not%20a%20boolean%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20+%20%27.%20%20The%20expected%20value%20was%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValue%20%21%3D%3D%20referenceToken%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%20%27%22%20is%20not%20equal%20to%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27number%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20the%20input%20not%20a%20number%2C%20then%20throw%20an%20error.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%21%3D%3D%20%27number%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20not%20a%20number%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20inputValue%20+%20%27.%20%20The%20expected%20value%20was%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20difference%20%3D%20Math.abs%28inputValue%20-%20referenceToken%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28isNaN%28difference%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20absolute%20value%20of%20the%20input%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValue%20+%20%27%22%20-%20the%20referenceToken%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%20is%20NaN%3F%20%20It%20should%20be%20less%20than%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.getParameter%28%27tolerance%27%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28difference%20%3E%20self.getParameter%28%27tolerance%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%20%27%22%20is%20not%20within%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.getParameter%28%27tolerance%27%29%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20of%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27string%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValue%20%21%3D%3D%20referenceToken%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20devices/test/auto/WatchEmulator.js%20needs%20this%20test%20for%20object%20because%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20if%20we%20receive%20a%20JSON%20object%2C%20then%20we%20should%20try%20to%20stringify%20it.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValue%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20%28err%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValue%20+%20%27%22%20is%20%21%3D%3D%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20to%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%20%27%22.%20%20The%20input%20was%20an%20object%2C%20and%20a%20string%20was%20expected.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%21%3D%3D%20referenceToken%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%20%27%22%20is%20%21%3D%3D%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20to%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceToken%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22.%20%20The%20input%20was%20an%20object%20and%20JSON.stringify%28%29%20did%20not%20throw%20an%20exception.%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27A%20string%20was%20expected.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20%28typeof%20referenceToken%20%3D%3D%3D%20%27object%27%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20JSON.stringify%28inputValue%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20%5B%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20referenceTokenValue%20%3D%20JSON.stringify%28referenceToken%2C%20function%20%28key%2C%20value%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20value%20%3D%3D%3D%20%27object%27%20%26%26%20value%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cache.indexOf%28value%29%20%21%3D%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Circular%20reference%20found%2C%20discard%20key%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Store%20value%20in%20our%20collection%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache.push%28value%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cache%20%3D%20null%3B%20//%20Enable%20garbage%20collection%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20we%20are%20comparing%20longs%20from%20CapeCode%2C%20then%20the%20values%20will%20be%20like%20%221L%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20and%20stringify%20will%20return%20undefined.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%3D%3D%3D%20undefined%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28referenceTokenValue%20%3D%3D%3D%20undefined%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceTokenValue%20%3D%20referenceToken%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%21%3D%3D%20referenceTokenValue%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20inputValueValue%20could%20still%20be%20undefined%20here%20if%20inputValue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20was%20undefined.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28inputValueValue%20%21%3D%3D%20undefined%20%26%26%20inputValueValue.length%20%3E%20100%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue%20%3D%20inputValueValue.substring%280%2C%20100%29%20+%20%27...%27%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28referenceTokenValue%20%21%3D%3D%20undefined%20%26%26%20referenceTokenValue.length%20%3E%20100%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceTokenValue%20%3D%20referenceTokenValue.substring%280%2C%20100%29%20+%20%27...%27%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20Deal%20with%20referenceTokens%20with%20value%201L.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28typeof%20inputValueValue%20%21%3D%3D%20%27object%27%20%7C%7C%20typeof%20referenceTokenValue%20%21%3D%3D%20%27object%27%20%26%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputValueValue.toString%28%29%20%21%3D%3D%20referenceTokenValue.toString%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27tokens%2C%20the%20input%20%22%27%20+%20inputValueValue%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20%21%3D%3D%20to%20the%20expected%20value%20%22%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20referenceTokenValue%20+%20%27%22%20typeof%20inputValueValue%3A%20%27%20+%20typeof%20inputValueValue%20+%20%27%20typeof%20referenceTokenValue%3A%20%27%20+%20typeof%20referenceTokenValue%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28self.accessorName%20+%20%27%3A%20After%20seeing%20%27%20+%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20the%20referenceToken%20%22%27%20+%20referenceToken%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%22%20is%20not%20a%20number%2C%20it%20is%20a%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20typeof%20referenceToken%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20numberOfInputTokensSeen%20+%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20If%20we%20are%20past%20the%20end%20of%20the%20expected%20inputs%2C%20then%20read%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28numberOfInputTokensSeen%20%3E%3D%20correctValuesValues.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20true%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20false%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27output%27%2C%20true%29%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20initialized%20%3D%20true%3B%0A%7D%3B%0A%0A/**%20If%20trainingMode%20is%20true%2C%20then%20updated%20the%20correctValues.%20*/%0Aexports.wrapup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20if%20%28this.getParameter%28%27trainingMode%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20this.setParameter%28%27correctValues%27%2C%20trainingTokens%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20%28initialized%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%21inputHandled%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20initialized%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28this.accessorName%20+%20%27%3A%20The%20input%20handler%20of%20this%20accessor%20was%20never%20invoked.%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27Usually%2C%20this%20is%20an%20error%20indicating%20that%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27starvation%20is%20occurring.%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20correctValuesValues%20%3D%20this.getParameter%28%27correctValues%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28numberOfInputTokensSeen%20%3C%20correctValuesValues.length%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20Error%28this.accessorName%20+%20%27%3A%20The%20test%20produced%20only%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20numberOfInputTokensSeen%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%2C%20yet%20the%20correctValues%20parameter%20was%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27expecting%20%27%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20correctValuesValues.length%20+%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%20tokens%27%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20initialized%20%3D%20false%3B%0A%20%20%20%20%7D%0A%20%20%20%20var%20name%20%3D%20this.accessorName%3B%0A%0A%20%20%20%20//%20FIXME%3A%20Should%20we%20check%20to%20see%20if%20the%20name%20has%20no%20dots%20in%20and%20if%0A%20%20%20%20//%20it%20does%20not%2C%20add%20the%20container%20name%3F%0A%0A%20%20%20%20//if%20%28this.container%29%20%7B%0A%20%20%20%20//%20%20%20%20name%20%3D%20this.container.accessorName%20+%20%22.%22%20+%20name%3B%0A%20%20%20%20//%7D%0A%0A%20%20%20%20//%0A%20%20%20%20exports.wrappedUp%20%3D%20true%3B%0A%20%20%20%20//%20console.log%28%22TrainableTest.js%3A%20wrapup%28%29%20finished%3A%20%22%20+%20name%20+%20%22%2C%20exports.wrappedUp%3A%20%22%20+%20exports.wrappedUp%29%3B%0A%0A%7D%3B%0A'));
    TrainableTest2.setParameter('correctValues', [0,1,2,0,1,3]);
    TrainableTest2.setParameter('trainingMode', false);
    TrainableTest2.setParameter('tolerance', 1.0E-9);

    // Start: TestDisplayServerReceived: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: TestDisplayServerReceived: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var TestDisplayServerReceived = this.instantiateFromCode('TestDisplayServerReceived', unescape('//%20Display%20data%20on%20the%20console.%0A//%0A//%20Copyright%20%28c%29%202016-2016%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A%0A/**%20Display%20data%20on%20the%20console%20using%20util.inspect%28%29.%0A%20*%0A%20*%20%20@accessor%20test/TestDisplay%0A%20*%20%20@param%20input%20The%20output%0A%20*%20%20@author%20Christopher%20Brooks%0A%20*%20%20@version%20%24%24Id%3A%20TestDisplay.js%202003%202017-08-03%2014%3A47%3A31Z%20eal%20%24%24%0A%20*/%0A%0A//%20Stop%20extra%20messages%20from%20jslint.%20%20Note%20that%20there%20should%20be%20no%0A//%20space%20between%20the%20/%20and%20the%20*%20and%20global.%0A/*globals%20console%2C%20error%2C%20exports%2C%20require%20*/%0A/*jshint%20globalstrict%3A%20true*/%0A%22use%20strict%22%3B%0A%0Avar%20util%20%3D%20require%28%27util%27%29%3B%0A%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.input%28%27input%27%29%3B%0A%20%20%20%20this.output%28%27output%27%29%3B%0A%7D%3B%0A%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.addInputHandler%28%27input%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20inputValue%20%3D%20this.get%28%27input%27%29%3B%0A%20%20%20%20%20%20%20%20console.log%28util.inspect%28inputValue%29%29%3B%0A%20%20%20%20%20%20%20%20this.send%28%27output%27%2C%20inputValue%29%3B%0A%20%20%20%20%7D%29%3B%0A%7D%3B%0A'));

    // Start: TestDisplayClientReceived: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: TestDisplayClientReceived: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var TestDisplayClientReceived = this.instantiateFromCode('TestDisplayClientReceived', unescape('//%20Display%20data%20on%20the%20console.%0A//%0A//%20Copyright%20%28c%29%202016-2016%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A%0A/**%20Display%20data%20on%20the%20console%20using%20util.inspect%28%29.%0A%20*%0A%20*%20%20@accessor%20test/TestDisplay%0A%20*%20%20@param%20input%20The%20output%0A%20*%20%20@author%20Christopher%20Brooks%0A%20*%20%20@version%20%24%24Id%3A%20TestDisplay.js%202003%202017-08-03%2014%3A47%3A31Z%20eal%20%24%24%0A%20*/%0A%0A//%20Stop%20extra%20messages%20from%20jslint.%20%20Note%20that%20there%20should%20be%20no%0A//%20space%20between%20the%20/%20and%20the%20*%20and%20global.%0A/*globals%20console%2C%20error%2C%20exports%2C%20require%20*/%0A/*jshint%20globalstrict%3A%20true*/%0A%22use%20strict%22%3B%0A%0Avar%20util%20%3D%20require%28%27util%27%29%3B%0A%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.input%28%27input%27%29%3B%0A%20%20%20%20this.output%28%27output%27%29%3B%0A%7D%3B%0A%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.addInputHandler%28%27input%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20inputValue%20%3D%20this.get%28%27input%27%29%3B%0A%20%20%20%20%20%20%20%20console.log%28util.inspect%28inputValue%29%29%3B%0A%20%20%20%20%20%20%20%20this.send%28%27output%27%2C%20inputValue%29%3B%0A%20%20%20%20%7D%29%3B%0A%7D%3B%0A'));

    // Start: JavaScriptConst: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var JavaScriptConst = this.instantiateFromCode('JavaScriptConst', unescape('/**%20Output%20a%20const%0A%20*%0A%20*%20%20@accessor%20test/Const%0A%20*%20%20@input%20trigger%20The%20trigger%0A%20*%20%20@output%20output%20The%20output%0A%20*%20%20@param%20step%20The%20amount%20by%20which%20the%20output%20is%20incremented.%20The%0A%20*%20%20default%20is%201.%0A%20*%20%20@author%20Christopher%20Brooks%0A%20*%20%20@version%20%24%24Id%3A%20TCPSocketUnsignedShort.xml%2076884%202017-09-22%2003%3A23%3A07Z%20cxh%20%24%24%0A%20*/%0Aexports.setup%20%3D%20function%28%29%20%7B%0A%20%20%20%20this.input%28%27trigger%27%29%3B%0A%20%20%20%20this.output%28%27output%27%29%3B%0A%7D%3B%0A%0Aexports.fire%20%3D%20function%28%29%20%7B%0A%09var%20value%20%3D%20%5B-1%2C%200%2C%201%2C%2065535%2C%2065536%2C%202%5D%3B%0A%20%20%20%20this.send%28%27output%27%2C%20value%29%3B%0A%7D%3B'));

    // Start: JavaScriptPlusOne: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var JavaScriptPlusOne = this.instantiateFromCode('JavaScriptPlusOne', unescape('/**%20Increment%20the%20input%20by%20one%0A%20*%0A%20*%20%20@input%20input%20The%20trigger%0A%20*%20%20@output%20output%20The%20output%0A%20*%20%20@author%20Christopher%20Brooks.%20Contributor%3A%20Edward%20A.%20Lee%0A%20*%20%20@version%20%24%24Id%3A%20TCPSocketUnsignedShort.xml%2076884%202017-09-22%2003%3A23%3A07Z%20cxh%20%24%24%0A%20*/%0A%0Aexports.setup%20%3D%20function%28%29%20%7B%0A%20%20%20%20this.input%28%27input%27%29%3B%0A%20%20%20%20//%20Declare%20the%20output%20to%20be%20spontaneous%20so%20that%20we%20don%27t%0A%20%20%20%20//%20need%20a%20MicrostepDelay%20actor%20in%20Cape%20Code.%20%20See%0A%20%20%20%20//%20https%3A//www.icyphy.org/accessors/wiki/Main/CapeCodeHost%23Loops%0A%20%20%20%20this.output%28%27output%27%2C%20%7Bspontaneous%3A%20true%2C%20%27type%27%3A%20%27number%27%7D%29%3B%0A%7D%3B%0A%0Aexports.initialize%20%3D%20function%28%29%20%7B%0A%20%20//%20Capture%20the%20value%20of%20%27this%27%3A%0A%20%20var%20self%20%3D%20this%3B%0A%20%20this.addInputHandler%28%27input%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20var%20inputValue%20%3D%20self.get%28%27input%27%29%3B%0A%20%20%20%20setTimeout%28function%28%29%20%7B%0A%20%20%20%20%09self.send%28%27output%27%2C%20inputValue%20+%201%29%3B%0A%20%20%20%20%7D%2C%200%29%3B%0A%20%20%7D%29%3B%0A%7D%3B%0A%0A'));

    // Connections: TCPSocketUnsignedShort: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/TypedCompositeActor.java
    this.connect(TCPSocketServer, 'listening', TCPSocketClient, 'port');
    this.connect(JavaScriptConst, 'output', TCPSocketClient, 'toSend');
    this.connect(JavaScriptPlusOne, 'output', TCPSocketServer, 'toSend');
    this.connect(TCPSocketServer, 'received', TrainableTest, 'input');
    this.connect(TCPSocketClient, 'received', TrainableTest2, 'input');
    this.connect(TCPSocketServer, 'received', TestDisplayServerReceived, 'input');
    this.connect(TCPSocketClient, 'received', TestDisplayClientReceived, 'input');
    this.connect(TCPSocketServer, 'connection', JavaScriptConst, 'trigger');
    this.connect(TestDisplayServerReceived, 'output', JavaScriptPlusOne, 'input');
};

// To update the initialize code below, modify
//   $PTII/ptolemy/cg/kernel/generic/accessor/AccessorCodeGenerator.java
if (exports.initialize) {
    var originalInitialize = exports.initialize;
    exports.initialize = function() {
        originalInitialize.call(this);
        this.stopAt(2000.0);
    }
} else {
    exports.initialize = function() {
        this.stopAt(2000.0);
    }
}
