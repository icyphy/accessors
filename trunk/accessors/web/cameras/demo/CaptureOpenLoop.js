exports.setup = function () {
    //  This composite accessor was created by Cape Code.
    //  To run the code, run: 
    //  (cd $PTII/org/terraswarm/accessor/accessors/web/cameras/demo; node ../../node_modules/@accessors-hosts/node/nodeHostInvoke.js cameras/demo/CaptureOpenLoop)
    //  To regenerate this composite accessor, run:
    //  $PTII/bin/ptinvoke ptolemy.cg.kernel.generic.accessor.AccessorCodeGenerator -language accessor $PTII/./ptolemy/actor/lib/jjs/modules/cameras/demo/Camera/CaptureOpenLoop.xml
    //  to edit the model, run:
    //  $PTII/bin/capecode $PTII/./ptolemy/actor/lib/jjs/modules/cameras/demo/Camera/CaptureOpenLoop.xml

    // Ports: CaptureOpenLoop: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/TypedCompositeActor.java

    // Start: Camera: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: Camera: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var Camera = this.instantiateFromCode('Camera', unescape('//%20Copyright%20%28c%29%202015-2017%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A%0A/**%20An%20accessor%20for%20a%20camera%20on%20the%20local%20host.%20This%20can%20be%20a%20built-in%20camera%20or%0A%20*%20%20a%20USB-connected%20camera.%20This%20accessor%20has%20two%20modes%20of%20operation%2C%20%22triggered%22%0A%20*%20%20and%20%22open%20loop.%22%20In%20triggered%20mode%2C%20it%20captures%20an%20image%20whenever%20a%20trigger%0A%20*%20%20input%20is%20received%20and%20produces%20that%20image%20on%20its%20output.%20In%20open-loop%20mode%2C%0A%20*%20%20it%20captures%20every%20image%20produced%20by%20the%20camera%2C%20at%20the%20speed%20of%20the%20camera%2C%0A%20*%20%20and%20produces%20on%20the%20output%20a%20stream%20of%20such%20images.%0A%20*%0A%20*%20%20@accessor%20cameras/Camera%0A%20*%20%20@author%20Edward%20A.%20Lee%20%28eal@eecs.berkeley.edu%29%0A%20*%20%20@input%20trigger%20A%20trigger%20input%20for%20triggered%20mode.%0A%20*%20%20%20The%20value%20is%20ignored%20and%20can%20be%20anything.%0A%20*%20%20@output%20%7BObject%7D%20image%20A%20stream%20of%20captured%20images.%0A%20*%20%20@parameter%20%7Bboolean%7D%20triggered%20If%20true%2C%20use%20triggered%20mode.%0A%20*%20%20%20Otherwise%2C%20use%20open-loop%20mode.%20This%20is%20a%20boolean%20that%20defaults%20to%20true.%0A%20*%20%20@parameter%20%7Bstring%7D%20camera%20The%20name%20of%20the%20camera%20to%20use.%0A%20*%20%20%20A%20list%20of%20available%20cameras%20is%20presented%20as%20options.%0A%20*%20%20%20This%20is%20a%20string%20that%20defaults%20to%20%22default%20camera%22%2C%0A%20*%20%20%20which%20uses%20the%20system%20default%2C%20if%20there%20is%20one.%0A%20*%20%20@parameter%20%7B%7Bwidth%3A%20number%2C%20height%3A%20number%7D%7D%20viewSize%20The%20view%20size%0A%20*%20%20%20to%20use%20for%20capture%2C%20in%20pixels.%20A%20list%20of%20available%20view%20sizes%20for%0A%20*%20%20%20the%20selected%20camara%20is%20presented%20as%20options.%20This%20is%20a%20JSON%20specification%0A%20*%20%20%20with%20a%20%22width%22%20and%20%22height%22%20field%2C%20as%20in%20for%20example%20%7B%22width%22%3A640%2C%20%22height%22%3A480%7D.%0A%20*%20%20@version%20%24%24Id%3A%20Camera.js%201597%202017-04-29%2015%3A41%3A50Z%20cxh%20%24%24%0A%20*/%0A%0A//%20Stop%20extra%20messages%20from%20jslint%20and%20jshint.%20%20Note%20that%20there%20should%20be%20no%0A//%20space%20between%20the%20/%20and%20the%20*%20and%20global.%20See%20https%3A//chess.eecs.berkeley.edu/ptexternal/wiki/Main/JSHint%20*/%0A/*global%20addInputHandler%2C%20error%2C%20exports%2C%20getParameter%2C%20input%2C%20output%2C%20parameter%2C%20removeInputHandler%2C%20require%2C%20send%20*/%0A/*jshint%20globalstrict%3A%20true*/%0A%22use%20strict%22%3B%0A%0Avar%20cameras%20%3D%20require%28%22@accessors-modules/cameras%22%29%3B%0Avar%20camera%3B%0Avar%20handle%20%3D%20null%3B%0A%0A/**%20Create%20the%20inputs%2C%20outputs%2C%20and%20parameters%2C%20and%20update%20the%20parameters%20for%20the%20selected%20camera.%20*/%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.input%28%27trigger%27%29%3B%0A%20%20%20%20this.output%28%27image%27%29%3B%0A%20%20%20%20this.parameter%28%27triggered%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27boolean%27%2C%0A%20%20%20%20%20%20%20%20%27value%27%3A%20true%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20//%20NOTE%3A%20The%20following%20assumes%20that%20setup%28%29%20is%20reinvoked%20whenever%20a%20parameter%0A%20%20%20%20//%20value%20changes%2C%20since%20the%20camera%20will%20change%20and%20so%20will%20the%20available%20options.%0A%20%20%20%20this.parameter%28%27camera%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27string%27%2C%0A%20%20%20%20%20%20%20%20%27value%27%3A%20%27default%20camera%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20this.parameter%28%27viewSize%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%27type%27%3A%20%27JSON%27%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20//%20This%20is%20in%20a%20try-catch%20so%20that%20this%20accessor%20can%20be%20instantiated%20even%20if%20the%0A%20%20%20%20//%20host%20does%20not%20provide%20a%20cameras%20module.%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20this.parameter%28%27camera%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%27options%27%3A%20cameras.cameras%28%29%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20camera%20%3D%20new%20cameras.Camera%28this.getParameter%28%27camera%27%29%29%3B%0A%20%20%20%20%20%20%20%20this.parameter%28%27viewSize%27%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%27value%27%3A%20camera.getViewSize%28%29%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%27options%27%3A%20camera.viewSizes%28%29%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%20catch%20%28err%29%20%7B%0A%20%20%20%20%20%20%20%20error%28err%29%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A/**%20Set%20the%20view%20size%20of%20the%20camera%2C%20open%20it%2C%20and%20depending%20on%20the%20triggered%20mode%2C%20either%0A%20*%20%20set%20up%20an%20input%20handler%20for%20the%20trigger%20input%20or%20set%20up%20a%20handler%20for%20the%20%27image%27%0A%20*%20%20event%20notification%20from%20the%20camera.%0A%20*/%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20camera.setViewSize%28this.getParameter%28%27viewSize%27%29%29%3B%0A%20%20%20%20camera.open%28%29%3B%0A%20%20%20%20var%20self%20%3D%20this%3B%0A%20%20%20%20if%20%28this.getParameter%28%27triggered%27%29%29%20%7B%0A%20%20%20%20%20%20%20%20//%20Request%20a%20snapshot.%20%20Note%20the%20video%20stream%20might%20not%20be%20playing.%0A%20%20%20%20%20%20%20%20//%20An%20event%20will%20be%20generated%20when%20a%20snapshot%20is%20available.%0A%20%20%20%20%20%20%20%20camera.on%28%27snapshot%27%2C%20function%20%28image%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27image%27%2C%20image%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20handle%20%3D%20this.addInputHandler%28%27trigger%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20camera.snapshot%28%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20camera.on%28%27image%27%2C%20function%20%28image%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20self.send%28%27image%27%2C%20image%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A/**%20Remove%20handlers%20and%20close%20the%20camera.%20*/%0Aexports.wrapup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20camera.removeAllListeners%28%27image%27%29%3B%0A%20%20%20%20if%20%28handle%20%21%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20this.removeInputHandler%28handle%29%3B%0A%20%20%20%20%7D%0A%20%20%20%20camera.close%28%29%3B%0A%7D%3B%0A'));
    Camera.setParameter('triggered', false);
    Camera.setParameter('camera', "default camera");
    Camera.setParameter('viewSize', {"width":640, "height":480});

    // Start: ImageDisplay: ptolemy/cg/adapter/generic/accessor/adapters/org/terraswarm/accessor/JSAccessor.java
    // The script has local modifications, so it is being emitted.

    // Start: ImageDisplay: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/lib/jjs/JavaScript.java
    // FIXME: See instantiate() in accessors/web/hosts/common/commonHost.js
    // We probably need to do something with the bindings.
    var ImageDisplay = this.instantiateFromCode('ImageDisplay', unescape('//%20Display%20an%20image%20on%20the%20console.%0A//%0A//%20Copyright%20%28c%29%202017%20The%20Regents%20of%20the%20University%20of%20California.%0A//%20All%20rights%20reserved.%0A//%0A//%20Permission%20is%20hereby%20granted%2C%20without%20written%20agreement%20and%20without%0A//%20license%20or%20royalty%20fees%2C%20to%20use%2C%20copy%2C%20modify%2C%20and%20distribute%20this%0A//%20software%20and%20its%20documentation%20for%20any%20purpose%2C%20provided%20that%20the%20above%0A//%20copyright%20notice%20and%20the%20following%20two%20paragraphs%20appear%20in%20all%20copies%0A//%20of%20this%20software.%0A//%0A//%20IN%20NO%20EVENT%20SHALL%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20BE%20LIABLE%20TO%20ANY%20PARTY%0A//%20FOR%20DIRECT%2C%20INDIRECT%2C%20SPECIAL%2C%20INCIDENTAL%2C%20OR%20CONSEQUENTIAL%20DAMAGES%0A//%20ARISING%20OUT%20OF%20THE%20USE%20OF%20THIS%20SOFTWARE%20AND%20ITS%20DOCUMENTATION%2C%20EVEN%20IF%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20HAS%20BEEN%20ADVISED%20OF%20THE%20POSSIBILITY%20OF%0A//%20SUCH%20DAMAGE.%0A//%0A//%20THE%20UNIVERSITY%20OF%20CALIFORNIA%20SPECIFICALLY%20DISCLAIMS%20ANY%20WARRANTIES%2C%0A//%20INCLUDING%2C%20BUT%20NOT%20LIMITED%20TO%2C%20THE%20IMPLIED%20WARRANTIES%20OF%0A//%20MERCHANTABILITY%20AND%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%20THE%20SOFTWARE%0A//%20PROVIDED%20HEREUNDER%20IS%20ON%20AN%20%22AS%20IS%22%20BASIS%2C%20AND%20THE%20UNIVERSITY%20OF%0A//%20CALIFORNIA%20HAS%20NO%20OBLIGATION%20TO%20PROVIDE%20MAINTENANCE%2C%20SUPPORT%2C%20UPDATES%2C%0A//%20ENHANCEMENTS%2C%20OR%20MODIFICATIONS.%0A//%0A%0A/**%20Display%20an%20image%20on%20the%20console.%0A%20*%0A%20*%20%20@accessor%20image/ImageDisplay%0A%20*%20%20@param%20input%20The%20output%0A%20*%20%20@author%20Christopher%20Brooks%0A%20*%20%20@version%20%24%24Id%3A%20ImageDisplay.js%201637%202017-05-05%2018%3A21%3A24Z%20cxh%20%24%24%0A%20*/%0A%0A//%20Stop%20extra%20messages%20from%20jslint.%20%20Note%20that%20there%20should%20be%20no%0A//%20space%20between%20the%20/%20and%20the%20*%20and%20global.%0A/*globals%20console%2C%20error%2C%20exports%2C%20require%20*/%0A/*jshint%20globalstrict%3A%20true*/%0A%22use%20strict%22%3B%0A%0Avar%20imageDisplay%20%3D%20require%28%27@accessors-modules/image-display%27%29%3B%0Avar%20display%20%3D%20null%3B%0A%0Aexports.setup%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20this.input%28%27input%27%29%3B%0A%20%20%20%20this.output%28%27output%27%29%3B%0A%7D%3B%0A%0Aexports.initialize%20%3D%20function%20%28%29%20%7B%0A%20%20%20%20if%20%28display%20%3D%3D%3D%20null%29%20%7B%0A%20%20%20%20%20%20%20%20display%20%3D%20new%20imageDisplay.ImageDisplay%28%29%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.addInputHandler%28%27input%27%2C%20function%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20var%20inputValue%20%3D%20this.get%28%27input%27%29%3B%0A%20%20%20%20%20%20%20%20display.displayImage%28inputValue%29%3B%0A%20%20%20%20%20%20%20%20this.send%28%27output%27%2C%20inputValue%29%3B%0A%20%20%20%20%7D%29%3B%0A%7D%3B%0A'));

    // Connections: CaptureOpenLoop: ptolemy/cg/adapter/generic/accessor/adapters/ptolemy/actor/TypedCompositeActor.java
    this.connect(Camera, 'image', ImageDisplay, 'input');
};

// To update the initialize code below, modify
//   $PTII/ptolemy/cg/kernel/generic/accessor/AccessorCodeGenerator.java
if (exports.initialize) {
    var originalInitialize = exports.initialize;
    exports.initialize = function() {
        originalInitialize.call(this);
        this.stopAt(20000.0);
    }
} else {
    exports.initialize = function() {
        this.stopAt(20000.0);
    }
}
